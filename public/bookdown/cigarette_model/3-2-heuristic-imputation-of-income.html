<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="3.2 Heuristic Imputation of Income | Aim #2: Mathematical Model" />
<meta property="og:type" content="book" />


<meta property="og:description" content="This book contains the analyses for the mathematical model for Aim #2 of Charlie’s dissertation" />


<meta name="author" content="Charles Marks" />

<meta name="date" content="2021-04-12" />


<meta name="description" content="This book contains the analyses for the mathematical model for Aim #2 of Charlie’s dissertation">

<title>3.2 Heuristic Imputation of Income | Aim #2: Mathematical Model</title>

<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#in-this-book"><span class="toc-section-number">1</span> In This Book</a></li>
<li><a href="2-dataset.html#dataset"><span class="toc-section-number">2</span> Generating the Initial Dataset</a>
<ul>
<li><a href="2-1-participants.html#participants"><span class="toc-section-number">2.1</span> Participants</a></li>
<li><a href="2-2-defining-variables-we-wish-to-capture.html#defining-variables-we-wish-to-capture"><span class="toc-section-number">2.2</span> Defining Variables We Wish to Capture</a></li>
<li><a href="2-3-loading-the-necessary-datasets.html#loading-the-necessary-datasets"><span class="toc-section-number">2.3</span> Loading the Necessary Datasets</a></li>
<li><a href="2-4-iterating-through-the-datasets.html#iterating-through-the-datasets"><span class="toc-section-number">2.4</span> Iterating Through the Datasets</a></li>
<li><a href="2-5-factoring-the-data.html#factoring-the-data"><span class="toc-section-number">2.5</span> Factoring the Data</a></li>
<li><a href="2-6-adding-the-weights-and-replicate-weights-to-the-study.html#adding-the-weights-and-replicate-weights-to-the-study"><span class="toc-section-number">2.6</span> Adding the Weights and Replicate Weights to the Study</a></li>
<li><a href="2-7-save-the-data-frame-for-future-use.html#save-the-data-frame-for-future-use"><span class="toc-section-number">2.7</span> Save the Data Frame for Future Use</a></li>
</ul></li>
<li><a href="3-imputation.html#imputation"><span class="toc-section-number">3</span> Data Imputation</a>
<ul>
<li><a href="3-1-loading-libraries-and-the-data.html#loading-libraries-and-the-data"><span class="toc-section-number">3.1</span> Loading Libraries and the Data</a></li>
<li><a href="3-2-heuristic-imputation-of-income.html#heuristic-imputation-of-income"><span class="toc-section-number">3.2</span> Heuristic Imputation of Income</a></li>
<li><a href="3-3-heuristic-imputation-of-former-cige-cig-use.html#heuristic-imputation-of-former-cige-cig-use"><span class="toc-section-number">3.3</span> Heuristic Imputation of Former Cig/E-Cig Use</a></li>
<li><a href="3-4-imputation-with-mice.html#imputation-with-mice"><span class="toc-section-number">3.4</span> Imputation with <em>mice()</em></a></li>
<li><a href="3-5-generating-some-additional-variables.html#generating-some-additional-variables"><span class="toc-section-number">3.5</span> Generating Some Additional Variables</a>
<ul>
<li><a href="3-5-generating-some-additional-variables.html#cateogry-cigarette-and-e-cigarette-use"><span class="toc-section-number">3.5.1</span> 3-Cateogry Cigarette and E-Cigarette Use</a></li>
<li><a href="3-5-generating-some-additional-variables.html#income-change-from-waves-1---2"><span class="toc-section-number">3.5.2</span> Income Change from Waves 1 - 2</a></li>
</ul></li>
<li><a href="3-6-output-the-imputed-dataset.html#output-the-imputed-dataset"><span class="toc-section-number">3.6</span> Output the Imputed Dataset</a></li>
</ul></li>
<li><a href="4-paramset.html#paramset"><span class="toc-section-number">4</span> Generate Parameter Set</a></li>
<li><a href="5-ode.html#ode"><span class="toc-section-number">5</span> ODE Functions</a>
<ul>
<li><a href="5-1-helper-functions.html#helper-functions"><span class="toc-section-number">5.1</span> Helper Functions</a></li>
</ul></li>
<li><a href="6-calibration.html#calibration"><span class="toc-section-number">6</span> Calibration</a></li>
<li><a href="7-start.html#start"><span class="toc-section-number">7</span> Initial Start State</a>
<ul>
<li><a href="7-1-stratifying-by-sex-and-age.html#stratifying-by-sex-and-age"><span class="toc-section-number">7.1</span> Stratifying by Sex and Age</a></li>
<li><a href="7-2-stratifying-the-population-by-income-level.html#stratifying-the-population-by-income-level"><span class="toc-section-number">7.2</span> Stratifying the Population by Income Level</a></li>
<li><a href="7-3-distributing-cigarette-use.html#distributing-cigarette-use"><span class="toc-section-number">7.3</span> Distributing Cigarette Use</a></li>
<li><a href="7-4-distributing-e-cigarette-use.html#distributing-e-cigarette-use"><span class="toc-section-number">7.4</span> Distributing E-Cigarette Use</a></li>
<li><a href="7-5-outputting-states-to-confirm.html#outputting-states-to-confirm"><span class="toc-section-number">7.5</span> Outputting States to Confirm</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="heuristic-imputation-of-income" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Heuristic Imputation of Income</h2>
<p>First, we are going to undertake a heuristic imputation for missing income values. We are making the assumption that if we know a person’s income at Wave X, then this is the best guess for their missing income value at Wave Y. To the best of our ability, we want to avoid imputing based on relationships between the variables, as that may influence our regression and modeling results in unintended ways. In total, 391 participants had missing income data from all 3 waves which could not be imputed via this method.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="3-2-heuristic-imputation-of-income.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Loop through each participant one at a time</span></span>
<span id="cb9-2"><a href="3-2-heuristic-imputation-of-income.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data)){</span>
<span id="cb9-3"><a href="3-2-heuristic-imputation-of-income.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-4"><a href="3-2-heuristic-imputation-of-income.html#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## First we extract the income level at each wave</span></span>
<span id="cb9-5"><a href="3-2-heuristic-imputation-of-income.html#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Missing data will show up as an NA</span></span>
<span id="cb9-6"><a href="3-2-heuristic-imputation-of-income.html#cb9-6" aria-hidden="true" tabindex="-1"></a>  wave1_inc <span class="ot">&lt;-</span> data<span class="sc">$</span>wave1_income[i]</span>
<span id="cb9-7"><a href="3-2-heuristic-imputation-of-income.html#cb9-7" aria-hidden="true" tabindex="-1"></a>  wave2_inc <span class="ot">&lt;-</span> data<span class="sc">$</span>wave2_income[i]</span>
<span id="cb9-8"><a href="3-2-heuristic-imputation-of-income.html#cb9-8" aria-hidden="true" tabindex="-1"></a>  wave3_inc <span class="ot">&lt;-</span> data<span class="sc">$</span>wave3_income[i]</span>
<span id="cb9-9"><a href="3-2-heuristic-imputation-of-income.html#cb9-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-10"><a href="3-2-heuristic-imputation-of-income.html#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">## If the Wave 1 data is missing:</span></span>
<span id="cb9-11"><a href="3-2-heuristic-imputation-of-income.html#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.na</span>(wave1_inc)){</span>
<span id="cb9-12"><a href="3-2-heuristic-imputation-of-income.html#cb9-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-13"><a href="3-2-heuristic-imputation-of-income.html#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="do">## First check if Wave 2 data is available, if so, set the Wave 1 value to equal Wave 2&#39;s</span></span>
<span id="cb9-14"><a href="3-2-heuristic-imputation-of-income.html#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave2_inc)){</span>
<span id="cb9-15"><a href="3-2-heuristic-imputation-of-income.html#cb9-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-16"><a href="3-2-heuristic-imputation-of-income.html#cb9-16" aria-hidden="true" tabindex="-1"></a>      data<span class="sc">$</span>wave1_income[i] <span class="ot">&lt;-</span> wave2_inc</span>
<span id="cb9-17"><a href="3-2-heuristic-imputation-of-income.html#cb9-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-18"><a href="3-2-heuristic-imputation-of-income.html#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="do">## If the Wave 2 data is also missing, check Wave 3 and set Wave 1 equal to the Wave 3 value    </span></span>
<span id="cb9-19"><a href="3-2-heuristic-imputation-of-income.html#cb9-19" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span> <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave3_inc)){</span>
<span id="cb9-20"><a href="3-2-heuristic-imputation-of-income.html#cb9-20" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-21"><a href="3-2-heuristic-imputation-of-income.html#cb9-21" aria-hidden="true" tabindex="-1"></a>      data<span class="sc">$</span>wave1_income[i] <span class="ot">&lt;-</span> wave3_inc</span>
<span id="cb9-22"><a href="3-2-heuristic-imputation-of-income.html#cb9-22" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-23"><a href="3-2-heuristic-imputation-of-income.html#cb9-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-24"><a href="3-2-heuristic-imputation-of-income.html#cb9-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-25"><a href="3-2-heuristic-imputation-of-income.html#cb9-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-26"><a href="3-2-heuristic-imputation-of-income.html#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="do">## We shall repeat a similar process for Wave 2</span></span>
<span id="cb9-27"><a href="3-2-heuristic-imputation-of-income.html#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="do">## If Wave 2 income value is NA:</span></span>
<span id="cb9-28"><a href="3-2-heuristic-imputation-of-income.html#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.na</span>(wave2_inc)){</span>
<span id="cb9-29"><a href="3-2-heuristic-imputation-of-income.html#cb9-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-30"><a href="3-2-heuristic-imputation-of-income.html#cb9-30" aria-hidden="true" tabindex="-1"></a>    <span class="do">## First we will check Wave 3</span></span>
<span id="cb9-31"><a href="3-2-heuristic-imputation-of-income.html#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave3_inc)){</span>
<span id="cb9-32"><a href="3-2-heuristic-imputation-of-income.html#cb9-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-33"><a href="3-2-heuristic-imputation-of-income.html#cb9-33" aria-hidden="true" tabindex="-1"></a>      data<span class="sc">$</span>wave2_income[i] <span class="ot">&lt;-</span> wave3_inc</span>
<span id="cb9-34"><a href="3-2-heuristic-imputation-of-income.html#cb9-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-35"><a href="3-2-heuristic-imputation-of-income.html#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="do">## If the Wave 3 value is NA, then we will check the Wave 1 value    </span></span>
<span id="cb9-36"><a href="3-2-heuristic-imputation-of-income.html#cb9-36" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span> <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave1_inc)){</span>
<span id="cb9-37"><a href="3-2-heuristic-imputation-of-income.html#cb9-37" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-38"><a href="3-2-heuristic-imputation-of-income.html#cb9-38" aria-hidden="true" tabindex="-1"></a>      data<span class="sc">$</span>wave2_income[i] <span class="ot">&lt;-</span> wave1_inc</span>
<span id="cb9-39"><a href="3-2-heuristic-imputation-of-income.html#cb9-39" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-40"><a href="3-2-heuristic-imputation-of-income.html#cb9-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-41"><a href="3-2-heuristic-imputation-of-income.html#cb9-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-42"><a href="3-2-heuristic-imputation-of-income.html#cb9-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-43"><a href="3-2-heuristic-imputation-of-income.html#cb9-43" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Finally, we repeat this process for Wave 3</span></span>
<span id="cb9-44"><a href="3-2-heuristic-imputation-of-income.html#cb9-44" aria-hidden="true" tabindex="-1"></a>  <span class="do">## If Wave 3 value is NA:</span></span>
<span id="cb9-45"><a href="3-2-heuristic-imputation-of-income.html#cb9-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.na</span>(wave3_inc)){</span>
<span id="cb9-46"><a href="3-2-heuristic-imputation-of-income.html#cb9-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-47"><a href="3-2-heuristic-imputation-of-income.html#cb9-47" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Check the Wave 2 value</span></span>
<span id="cb9-48"><a href="3-2-heuristic-imputation-of-income.html#cb9-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave2_inc)){</span>
<span id="cb9-49"><a href="3-2-heuristic-imputation-of-income.html#cb9-49" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-50"><a href="3-2-heuristic-imputation-of-income.html#cb9-50" aria-hidden="true" tabindex="-1"></a>      data<span class="sc">$</span>wave3_income[i] <span class="ot">&lt;-</span> wave2_inc</span>
<span id="cb9-51"><a href="3-2-heuristic-imputation-of-income.html#cb9-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-52"><a href="3-2-heuristic-imputation-of-income.html#cb9-52" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Else if Wave 2 is also NA, we will check the Wave 1 value    </span></span>
<span id="cb9-53"><a href="3-2-heuristic-imputation-of-income.html#cb9-53" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span> <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave1_inc)){</span>
<span id="cb9-54"><a href="3-2-heuristic-imputation-of-income.html#cb9-54" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-55"><a href="3-2-heuristic-imputation-of-income.html#cb9-55" aria-hidden="true" tabindex="-1"></a>      data<span class="sc">$</span>wave3_income[i] <span class="ot">&lt;-</span> wave1_inc</span>
<span id="cb9-56"><a href="3-2-heuristic-imputation-of-income.html#cb9-56" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-57"><a href="3-2-heuristic-imputation-of-income.html#cb9-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-58"><a href="3-2-heuristic-imputation-of-income.html#cb9-58" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-59"><a href="3-2-heuristic-imputation-of-income.html#cb9-59" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p style="text-align: center;">
<a href="3-1-loading-libraries-and-the-data.html"><button class="btn btn-default">Previous</button></a>
<a href="3-3-heuristic-imputation-of-former-cige-cig-use.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
