<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 ODE Functions | Aim #2: Mathematical Model</title>
  <meta name="description" content="This book contains the analyses for the mathematical model for Aim #2 of Charlie’s dissertation" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 ODE Functions | Aim #2: Mathematical Model" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book contains the analyses for the mathematical model for Aim #2 of Charlie’s dissertation" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 ODE Functions | Aim #2: Mathematical Model" />
  
  <meta name="twitter:description" content="This book contains the analyses for the mathematical model for Aim #2 of Charlie’s dissertation" />
  

<meta name="author" content="Charles Marks" />


<meta name="date" content="2021-04-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="start.html"/>
<link rel="next" href="calibration.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> In This Book</a></li>
<li class="chapter" data-level="2" data-path="dataset.html"><a href="dataset.html"><i class="fa fa-check"></i><b>2</b> Generating the Initial Dataset</a>
<ul>
<li class="chapter" data-level="2.1" data-path="dataset.html"><a href="dataset.html#participants"><i class="fa fa-check"></i><b>2.1</b> Participants</a></li>
<li class="chapter" data-level="2.2" data-path="dataset.html"><a href="dataset.html#defining-variables-we-wish-to-capture"><i class="fa fa-check"></i><b>2.2</b> Defining Variables We Wish to Capture</a></li>
<li class="chapter" data-level="2.3" data-path="dataset.html"><a href="dataset.html#loading-the-necessary-datasets"><i class="fa fa-check"></i><b>2.3</b> Loading the Necessary Datasets</a></li>
<li class="chapter" data-level="2.4" data-path="dataset.html"><a href="dataset.html#iterating-through-the-datasets"><i class="fa fa-check"></i><b>2.4</b> Iterating Through the Datasets</a></li>
<li class="chapter" data-level="2.5" data-path="dataset.html"><a href="dataset.html#factoring-the-data"><i class="fa fa-check"></i><b>2.5</b> Factoring the Data</a></li>
<li class="chapter" data-level="2.6" data-path="dataset.html"><a href="dataset.html#adding-the-weights-and-replicate-weights-to-the-study"><i class="fa fa-check"></i><b>2.6</b> Adding the Weights and Replicate Weights to the Study</a></li>
<li class="chapter" data-level="2.7" data-path="dataset.html"><a href="dataset.html#save-the-data-frame-for-future-use"><i class="fa fa-check"></i><b>2.7</b> Save the Data Frame for Future Use</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="imputation.html"><a href="imputation.html"><i class="fa fa-check"></i><b>3</b> Data Imputation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="imputation.html"><a href="imputation.html#loading-libraries-and-the-data"><i class="fa fa-check"></i><b>3.1</b> Loading Libraries and the Data</a></li>
<li class="chapter" data-level="3.2" data-path="imputation.html"><a href="imputation.html#heuristic-imputation-of-income"><i class="fa fa-check"></i><b>3.2</b> Heuristic Imputation of Income</a></li>
<li class="chapter" data-level="3.3" data-path="imputation.html"><a href="imputation.html#heuristic-imputation-of-former-cige-cig-use"><i class="fa fa-check"></i><b>3.3</b> Heuristic Imputation of Former Cig/E-Cig Use</a></li>
<li class="chapter" data-level="3.4" data-path="imputation.html"><a href="imputation.html#imputation-with-mice"><i class="fa fa-check"></i><b>3.4</b> Imputation with <em>mice()</em></a></li>
<li class="chapter" data-level="3.5" data-path="imputation.html"><a href="imputation.html#generating-some-additional-variables"><i class="fa fa-check"></i><b>3.5</b> Generating Some Additional Variables</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="imputation.html"><a href="imputation.html#cateogry-cigarette-and-e-cigarette-use"><i class="fa fa-check"></i><b>3.5.1</b> 3-Cateogry Cigarette and E-Cigarette Use</a></li>
<li class="chapter" data-level="3.5.2" data-path="imputation.html"><a href="imputation.html#income-change-from-waves-1---2"><i class="fa fa-check"></i><b>3.5.2</b> Income Change from Waves 1 - 2</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="imputation.html"><a href="imputation.html#output-the-imputed-dataset"><i class="fa fa-check"></i><b>3.6</b> Output the Imputed Dataset</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="paramset.html"><a href="paramset.html"><i class="fa fa-check"></i><b>4</b> Generate Parameter Set</a>
<ul>
<li class="chapter" data-level="4.1" data-path="paramset.html"><a href="paramset.html#loading-necessary-packages-and-helper-functions"><i class="fa fa-check"></i><b>4.1</b> Loading Necessary Packages and Helper Functions</a></li>
<li class="chapter" data-level="4.2" data-path="paramset.html"><a href="paramset.html#set-some-hyperparamets-to-customize-parameter-set"><i class="fa fa-check"></i><b>4.2</b> Set Some Hyperparamets to Customize Parameter Set</a></li>
<li class="chapter" data-level="4.3" data-path="paramset.html"><a href="paramset.html#loading-our-dataset-and-defining-some-variables"><i class="fa fa-check"></i><b>4.3</b> Loading Our Dataset and Defining Some Variables</a></li>
<li class="chapter" data-level="4.4" data-path="paramset.html"><a href="paramset.html#defining-absolute-age-specific-income-transition-totals"><i class="fa fa-check"></i><b>4.4</b> Defining Absolute Age-Specific Income Transition Totals</a></li>
<li class="chapter" data-level="4.5" data-path="paramset.html"><a href="paramset.html#defining-cigarette-use-transitions"><i class="fa fa-check"></i><b>4.5</b> Defining Cigarette Use Transitions</a></li>
<li class="chapter" data-level="4.6" data-path="paramset.html"><a href="paramset.html#defining-e-cigarette-transitions"><i class="fa fa-check"></i><b>4.6</b> Defining E-Cigarette Transitions</a></li>
<li class="chapter" data-level="4.7" data-path="paramset.html"><a href="paramset.html#running-regression-analyses-to-extract-log-relative-risks"><i class="fa fa-check"></i><b>4.7</b> Running Regression Analyses to Extract Log-Relative Risks</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="paramset.html"><a href="paramset.html#defining-income-change-variable"><i class="fa fa-check"></i><b>4.7.1</b> Defining Income Change Variable</a></li>
<li class="chapter" data-level="4.7.2" data-path="paramset.html"><a href="paramset.html#cigarette-initiation-model"><i class="fa fa-check"></i><b>4.7.2</b> Cigarette Initiation Model</a></li>
<li class="chapter" data-level="4.7.3" data-path="paramset.html"><a href="paramset.html#cigarette-cessation-model"><i class="fa fa-check"></i><b>4.7.3</b> Cigarette Cessation Model</a></li>
<li class="chapter" data-level="4.7.4" data-path="paramset.html"><a href="paramset.html#cigarette-re-instatement-model"><i class="fa fa-check"></i><b>4.7.4</b> Cigarette Re-Instatement Model</a></li>
<li class="chapter" data-level="4.7.5" data-path="paramset.html"><a href="paramset.html#e-cigarette-initiation-model"><i class="fa fa-check"></i><b>4.7.5</b> E-Cigarette Initiation Model</a></li>
<li class="chapter" data-level="4.7.6" data-path="paramset.html"><a href="paramset.html#e-cigarette-cessation-model"><i class="fa fa-check"></i><b>4.7.6</b> E-Cigarette Cessation Model</a></li>
<li class="chapter" data-level="4.7.7" data-path="paramset.html"><a href="paramset.html#e-cigarette-reinstatement-model"><i class="fa fa-check"></i><b>4.7.7</b> E-Cigarette Reinstatement Model</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="paramset.html"><a href="paramset.html#drawing-our-parameter-set-samples"><i class="fa fa-check"></i><b>4.8</b> Drawing Our Parameter Set Samples</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="paramset.html"><a href="paramset.html#income-transitions-sample"><i class="fa fa-check"></i><b>4.8.1</b> Income Transitions Sample</a></li>
<li class="chapter" data-level="4.8.2" data-path="paramset.html"><a href="paramset.html#cigarette-transitions-sample"><i class="fa fa-check"></i><b>4.8.2</b> Cigarette Transitions Sample</a></li>
<li class="chapter" data-level="4.8.3" data-path="paramset.html"><a href="paramset.html#e-cigarette-transitions-sample"><i class="fa fa-check"></i><b>4.8.3</b> E-Cigarette Transitions Sample</a></li>
<li class="chapter" data-level="4.8.4" data-path="paramset.html"><a href="paramset.html#sampling-relative-risks"><i class="fa fa-check"></i><b>4.8.4</b> Sampling Relative Risks</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="paramset.html"><a href="paramset.html#generating-the-final-parameter-set-sampling"><i class="fa fa-check"></i><b>4.9</b> Generating the Final Parameter Set Sampling</a></li>
<li class="chapter" data-level="4.10" data-path="paramset.html"><a href="paramset.html#output-the-results"><i class="fa fa-check"></i><b>4.10</b> Output the Results</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="start.html"><a href="start.html"><i class="fa fa-check"></i><b>5</b> Initial Start State</a>
<ul>
<li class="chapter" data-level="5.1" data-path="start.html"><a href="start.html#stratifying-by-sex-and-age"><i class="fa fa-check"></i><b>5.1</b> Stratifying by Sex and Age</a></li>
<li class="chapter" data-level="5.2" data-path="start.html"><a href="start.html#stratifying-the-population-by-income-level"><i class="fa fa-check"></i><b>5.2</b> Stratifying the Population by Income Level</a></li>
<li class="chapter" data-level="5.3" data-path="start.html"><a href="start.html#distributing-cigarette-use"><i class="fa fa-check"></i><b>5.3</b> Distributing Cigarette Use</a></li>
<li class="chapter" data-level="5.4" data-path="start.html"><a href="start.html#distributing-e-cigarette-use"><i class="fa fa-check"></i><b>5.4</b> Distributing E-Cigarette Use</a></li>
<li class="chapter" data-level="5.5" data-path="start.html"><a href="start.html#saving-the-states"><i class="fa fa-check"></i><b>5.5</b> Saving the States</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ode.html"><a href="ode.html"><i class="fa fa-check"></i><b>6</b> ODE Functions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ode.html"><a href="ode.html#helper-functions"><i class="fa fa-check"></i><b>6.1</b> Helper Functions</a></li>
<li class="chapter" data-level="6.2" data-path="ode.html"><a href="ode.html#ode-function"><i class="fa fa-check"></i><b>6.2</b> ODE Function</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="calibration.html"><a href="calibration.html"><i class="fa fa-check"></i><b>7</b> Calibration</a></li>
<li class="chapter" data-level="8" data-path="ref.html"><a href="ref.html"><i class="fa fa-check"></i><b>8</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Aim #2: Mathematical Model</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ode" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> ODE Functions</h1>
<p>Prior to the next steps, we need to define the ODE (ordinary differential equations) solver for our model. This function is what we will call to run the model. So we need to define it prior to both the calibration and simulations steps. While the model is described in full detail in the manuscript, the main thing is that this model stratifies the population across 5 factors: age, sex, cigarette use status, e-cigarette use status, and household income.</p>
<p>A few notes on the implementation of the model:</p>
<ul>
<li>We use a dimensional coding strategy</li>
<li>We only permit transitions across one strata at a time</li>
<li>To improve runtime, the function is sex specific
<ul>
<li>No transitions are permitted across sex so can run separately</li>
<li>As shall be shown in the calibration and simulation stages, we will parallelize the running of the model across sex to improve runtime</li>
</ul></li>
<li>Finally, the function is intended to be run for initial never, current, and former smokers
<ul>
<li>By stratifying model runs, we are able to explore the impact of income on cigarette use amongst specific sub-populations</li>
</ul></li>
</ul>
<div id="helper-functions" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Helper Functions</h2>
<p>The ODE function is included below. Comments in the code are provided to clarify how the model functions:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="ode.html#cb39-1" aria-hidden="true" tabindex="-1"></a>toArray <span class="ot">&lt;-</span> <span class="cf">function</span>(vector, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">13</span>)){</span>
<span id="cb39-2"><a href="ode.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-3"><a href="ode.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  array_structure <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">dim =</span> dim)</span>
<span id="cb39-4"><a href="ode.html#cb39-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-5"><a href="ode.html#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">replace</span>(array_structure, <span class="cn">TRUE</span>, vector))</span>
<span id="cb39-6"><a href="ode.html#cb39-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-7"><a href="ode.html#cb39-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-8"><a href="ode.html#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="ode.html#cb39-9" aria-hidden="true" tabindex="-1"></a>toVector <span class="ot">&lt;-</span> <span class="cf">function</span>(array){</span>
<span id="cb39-10"><a href="ode.html#cb39-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-11"><a href="ode.html#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(array))</span>
<span id="cb39-12"><a href="ode.html#cb39-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-13"><a href="ode.html#cb39-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="ode-function" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> ODE Function</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="ode.html#cb40-1" aria-hidden="true" tabindex="-1"></a>de_fun_beta2_sex_w_death_and_entries <span class="ot">&lt;-</span> <span class="cf">function</span>(t, states, parameters){</span>
<span id="cb40-2"><a href="ode.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#with(as.list(c(states,parameters)),</span></span>
<span id="cb40-3"><a href="ode.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#    {</span></span>
<span id="cb40-4"><a href="ode.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-5"><a href="ode.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-6"><a href="ode.html#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb40-7"><a href="ode.html#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## AGE IFS COMPLETE</span></span>
<span id="cb40-8"><a href="ode.html#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb40-9"><a href="ode.html#cb40-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-10"><a href="ode.html#cb40-10" aria-hidden="true" tabindex="-1"></a>  states <span class="ot">&lt;-</span> <span class="fu">toArray</span>(states)</span>
<span id="cb40-11"><a href="ode.html#cb40-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-12"><a href="ode.html#cb40-12" aria-hidden="true" tabindex="-1"></a>  sex_types <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb40-13"><a href="ode.html#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 1 == Male, 2 == Female</span></span>
<span id="cb40-14"><a href="ode.html#cb40-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-15"><a href="ode.html#cb40-15" aria-hidden="true" tabindex="-1"></a>  age_types <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb40-16"><a href="ode.html#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 1 = 18-24, 2 = 25-34, 3 = 35-44, 4 = 45-54, 5 = 55-64, 6 = 65+</span></span>
<span id="cb40-17"><a href="ode.html#cb40-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-18"><a href="ode.html#cb40-18" aria-hidden="true" tabindex="-1"></a>  cigarette_types <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb40-19"><a href="ode.html#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 1 = Never Smoker, 2 = Current Smoker, 3 = Former Smoker</span></span>
<span id="cb40-20"><a href="ode.html#cb40-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-21"><a href="ode.html#cb40-21" aria-hidden="true" tabindex="-1"></a>  e_cigarette_types <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb40-22"><a href="ode.html#cb40-22" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 1 =  Never ESmoker, 2 = Current ESmoker, 3 = Former ESmoker</span></span>
<span id="cb40-23"><a href="ode.html#cb40-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-24"><a href="ode.html#cb40-24" aria-hidden="true" tabindex="-1"></a>  income_types <span class="ot">&lt;-</span> <span class="dv">13</span></span>
<span id="cb40-25"><a href="ode.html#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 1 = &lt;10k annually,   6 = &lt;10, decreased from previous</span></span>
<span id="cb40-26"><a href="ode.html#cb40-26" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 2 = 10-25k,          7 = 10-25k decreased from previous,     10 = 10-25k increased from previous</span></span>
<span id="cb40-27"><a href="ode.html#cb40-27" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 3 = 25-50k,          8 = 25-50k decreased from previous,     11 = 25-50k increased from previous</span></span>
<span id="cb40-28"><a href="ode.html#cb40-28" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 4 = 50-100k,         9 = 50-100k decreased from previous,    12 = increased from previous</span></span>
<span id="cb40-29"><a href="ode.html#cb40-29" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 5 = &gt;100k,                                                   13 = &gt;100k increased from previous</span></span>
<span id="cb40-30"><a href="ode.html#cb40-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-31"><a href="ode.html#cb40-31" aria-hidden="true" tabindex="-1"></a>  age_transitions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">7</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="dv">0</span>)</span>
<span id="cb40-32"><a href="ode.html#cb40-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-33"><a href="ode.html#cb40-33" aria-hidden="true" tabindex="-1"></a>  income_transition_sources <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">6</span>), <span class="do">## 1</span></span>
<span id="cb40-34"><a href="ode.html#cb40-34" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">10</span>), <span class="do">## 2 </span></span>
<span id="cb40-35"><a href="ode.html#cb40-35" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">11</span>), <span class="do">## 3</span></span>
<span id="cb40-36"><a href="ode.html#cb40-36" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">12</span>), <span class="do">## 4</span></span>
<span id="cb40-37"><a href="ode.html#cb40-37" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="dv">13</span>),   <span class="do">## 5</span></span>
<span id="cb40-38"><a href="ode.html#cb40-38" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>), <span class="do">## 6</span></span>
<span id="cb40-39"><a href="ode.html#cb40-39" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>), <span class="do">## 7</span></span>
<span id="cb40-40"><a href="ode.html#cb40-40" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">9</span>,<span class="dv">12</span>,<span class="dv">13</span>), <span class="do">## 8</span></span>
<span id="cb40-41"><a href="ode.html#cb40-41" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">13</span>), <span class="do">##9</span></span>
<span id="cb40-42"><a href="ode.html#cb40-42" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>), <span class="do">## 10</span></span>
<span id="cb40-43"><a href="ode.html#cb40-43" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">10</span>), <span class="do">## 11</span></span>
<span id="cb40-44"><a href="ode.html#cb40-44" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">11</span>), <span class="do">## 12</span></span>
<span id="cb40-45"><a href="ode.html#cb40-45" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>))<span class="do">## 13 </span></span>
<span id="cb40-46"><a href="ode.html#cb40-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-47"><a href="ode.html#cb40-47" aria-hidden="true" tabindex="-1"></a>  income_transition_landings <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>), <span class="do">## 1</span></span>
<span id="cb40-48"><a href="ode.html#cb40-48" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>), <span class="do">## 2 </span></span>
<span id="cb40-49"><a href="ode.html#cb40-49" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">12</span>,<span class="dv">13</span>), <span class="do">## 3</span></span>
<span id="cb40-50"><a href="ode.html#cb40-50" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">13</span>), <span class="do">## 4</span></span>
<span id="cb40-51"><a href="ode.html#cb40-51" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>),   <span class="do">## 5</span></span>
<span id="cb40-52"><a href="ode.html#cb40-52" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>), <span class="do">## 6</span></span>
<span id="cb40-53"><a href="ode.html#cb40-53" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>), <span class="do">## 7</span></span>
<span id="cb40-54"><a href="ode.html#cb40-54" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">12</span>,<span class="dv">13</span>), <span class="do">## 8</span></span>
<span id="cb40-55"><a href="ode.html#cb40-55" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">13</span>), <span class="do">##9</span></span>
<span id="cb40-56"><a href="ode.html#cb40-56" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>), <span class="do">## 10</span></span>
<span id="cb40-57"><a href="ode.html#cb40-57" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">12</span>,<span class="dv">13</span>), <span class="do">## 11</span></span>
<span id="cb40-58"><a href="ode.html#cb40-58" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">13</span>), <span class="do">## 12</span></span>
<span id="cb40-59"><a href="ode.html#cb40-59" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>))<span class="do">## 13 </span></span>
<span id="cb40-60"><a href="ode.html#cb40-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-61"><a href="ode.html#cb40-61" aria-hidden="true" tabindex="-1"></a>  <span class="do">## inputting input_5_cat[income_category] will return the value of just the income </span></span>
<span id="cb40-62"><a href="ode.html#cb40-62" aria-hidden="true" tabindex="-1"></a>  <span class="do">## (i.e. 10-25, increased to 10-25k, and decreased to 10-25k will all map to 10-25k)</span></span>
<span id="cb40-63"><a href="ode.html#cb40-63" aria-hidden="true" tabindex="-1"></a>  <span class="do">## (in other words income_5_cat[2] = income_5_cat[7] = income_5_cat = [10])</span></span>
<span id="cb40-64"><a href="ode.html#cb40-64" aria-hidden="true" tabindex="-1"></a>  income_5_cat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb40-65"><a href="ode.html#cb40-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-66"><a href="ode.html#cb40-66" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Only calculating income transition levels from the income values</span></span>
<span id="cb40-67"><a href="ode.html#cb40-67" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Not accounting for the income staging compartments</span></span>
<span id="cb40-68"><a href="ode.html#cb40-68" aria-hidden="true" tabindex="-1"></a>  income_transitions <span class="ot">&lt;-</span> <span class="fu">toArray</span>(parameters[<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>],<span class="at">dim =</span> <span class="fu">c</span>(age_types, <span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb40-69"><a href="ode.html#cb40-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-70"><a href="ode.html#cb40-70" aria-hidden="true" tabindex="-1"></a>  <span class="do">## the staging modifier controls how long individuals stay in the staging compartments assuming that they stay at the same income</span></span>
<span id="cb40-71"><a href="ode.html#cb40-71" aria-hidden="true" tabindex="-1"></a>  staging_modifier <span class="ot">&lt;-</span> parameters[<span class="dv">151</span>]</span>
<span id="cb40-72"><a href="ode.html#cb40-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-73"><a href="ode.html#cb40-73" aria-hidden="true" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb40-74"><a href="ode.html#cb40-74" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Smoking Transitions are for the referent group (Male, Age X, Income Y)</span></span>
<span id="cb40-75"><a href="ode.html#cb40-75" aria-hidden="true" tabindex="-1"></a>  cigarette_transitions <span class="ot">&lt;-</span> <span class="fu">toArray</span>(parameters[<span class="dv">152</span><span class="sc">:</span><span class="dv">160</span>],<span class="at">dim =</span> <span class="fu">c</span>(cigarette_types,cigarette_types))</span>
<span id="cb40-76"><a href="ode.html#cb40-76" aria-hidden="true" tabindex="-1"></a>  e_cigarette_transitions <span class="ot">&lt;-</span> <span class="fu">toArray</span>(parameters[<span class="dv">161</span><span class="sc">:</span><span class="dv">169</span>],<span class="at">dim =</span> <span class="fu">c</span>(e_cigarette_types, e_cigarette_types))</span>
<span id="cb40-77"><a href="ode.html#cb40-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-78"><a href="ode.html#cb40-78" aria-hidden="true" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb40-79"><a href="ode.html#cb40-79" aria-hidden="true" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb40-80"><a href="ode.html#cb40-80" aria-hidden="true" tabindex="-1"></a>  <span class="do">## This is for calibration</span></span>
<span id="cb40-81"><a href="ode.html#cb40-81" aria-hidden="true" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb40-82"><a href="ode.html#cb40-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-83"><a href="ode.html#cb40-83" aria-hidden="true" tabindex="-1"></a>  initiation_mod <span class="ot">&lt;-</span> parameters[<span class="dv">3061</span>]</span>
<span id="cb40-84"><a href="ode.html#cb40-84" aria-hidden="true" tabindex="-1"></a>  cessation_mod <span class="ot">&lt;-</span> parameters[<span class="dv">3062</span>]</span>
<span id="cb40-85"><a href="ode.html#cb40-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-86"><a href="ode.html#cb40-86" aria-hidden="true" tabindex="-1"></a>  cigarette_transitions[<span class="dv">1</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> cigarette_transitions[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>initiation_mod </span>
<span id="cb40-87"><a href="ode.html#cb40-87" aria-hidden="true" tabindex="-1"></a>  <span class="co">#cigarette_transitions[1,2] &lt;- initiation_mod </span></span>
<span id="cb40-88"><a href="ode.html#cb40-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-89"><a href="ode.html#cb40-89" aria-hidden="true" tabindex="-1"></a>  cigarette_transitions[<span class="dv">3</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> cigarette_transitions[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">*</span>initiation_mod</span>
<span id="cb40-90"><a href="ode.html#cb40-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-91"><a href="ode.html#cb40-91" aria-hidden="true" tabindex="-1"></a>  cigarette_transitions[<span class="dv">2</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> cigarette_transitions[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">*</span>cessation_mod</span>
<span id="cb40-92"><a href="ode.html#cb40-92" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-93"><a href="ode.html#cb40-93" aria-hidden="true" tabindex="-1"></a>  age_in <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb40-94"><a href="ode.html#cb40-94" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-95"><a href="ode.html#cb40-95" aria-hidden="true" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb40-96"><a href="ode.html#cb40-96" aria-hidden="true" tabindex="-1"></a>  <span class="do">## The relative risks can be interpreted as follows: </span></span>
<span id="cb40-97"><a href="ode.html#cb40-97" aria-hidden="true" tabindex="-1"></a>  <span class="do">## RR_income[income_level, X, Y] -&gt; the relative risk that a person at income level income_level transition from smoking level X to Y compared to referent income level</span></span>
<span id="cb40-98"><a href="ode.html#cb40-98" aria-hidden="true" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb40-99"><a href="ode.html#cb40-99" aria-hidden="true" tabindex="-1"></a>  rr_cigarette_initiation <span class="ot">&lt;-</span> <span class="fu">toArray</span>(parameters[<span class="dv">170</span><span class="sc">:</span><span class="dv">637</span>], <span class="at">dim =</span> <span class="fu">c</span>(sex_types,age_types,e_cigarette_types,income_types))</span>
<span id="cb40-100"><a href="ode.html#cb40-100" aria-hidden="true" tabindex="-1"></a>  rr_cigarette_cessation <span class="ot">&lt;-</span> <span class="fu">toArray</span>(parameters[<span class="dv">638</span><span class="sc">:</span><span class="dv">1105</span>], <span class="at">dim =</span> <span class="fu">c</span>(sex_types,age_types,e_cigarette_types,income_types))</span>
<span id="cb40-101"><a href="ode.html#cb40-101" aria-hidden="true" tabindex="-1"></a>  rr_cigarette_reinstatement <span class="ot">&lt;-</span> <span class="fu">toArray</span>(parameters[<span class="dv">1106</span><span class="sc">:</span><span class="dv">1573</span>], <span class="at">dim =</span> <span class="fu">c</span>(sex_types,age_types,e_cigarette_types,income_types))</span>
<span id="cb40-102"><a href="ode.html#cb40-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-103"><a href="ode.html#cb40-103" aria-hidden="true" tabindex="-1"></a>  rr_e_cigarette_initiation <span class="ot">&lt;-</span> <span class="fu">toArray</span>(parameters[<span class="dv">1574</span><span class="sc">:</span><span class="dv">2041</span>], <span class="at">dim =</span> <span class="fu">c</span>(sex_types,age_types,e_cigarette_types,income_types))</span>
<span id="cb40-104"><a href="ode.html#cb40-104" aria-hidden="true" tabindex="-1"></a>  rr_e_cigarette_cessation <span class="ot">&lt;-</span> <span class="fu">toArray</span>(parameters[<span class="dv">2042</span><span class="sc">:</span><span class="dv">2509</span>], <span class="at">dim =</span> <span class="fu">c</span>(sex_types,age_types,e_cigarette_types,income_types))</span>
<span id="cb40-105"><a href="ode.html#cb40-105" aria-hidden="true" tabindex="-1"></a>  rr_e_cigarette_reinstatement <span class="ot">&lt;-</span> <span class="fu">toArray</span>(parameters[<span class="dv">2510</span><span class="sc">:</span><span class="dv">2977</span>], <span class="at">dim =</span> <span class="fu">c</span>(sex_types,age_types,e_cigarette_types,income_types))</span>
<span id="cb40-106"><a href="ode.html#cb40-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-107"><a href="ode.html#cb40-107" aria-hidden="true" tabindex="-1"></a>  rr_e_cigarette_transitions <span class="ot">&lt;-</span> <span class="fu">toArray</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span><span class="sc">*</span>sex_types,age_types,e_cigarette_types, income_types), <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">3</span>,sex_types,age_types,e_cigarette_types,income_types))</span>
<span id="cb40-108"><a href="ode.html#cb40-108" aria-hidden="true" tabindex="-1"></a>  rr_e_cigarette_transitions[<span class="dv">1</span>,,,,] <span class="ot">&lt;-</span> rr_e_cigarette_initiation</span>
<span id="cb40-109"><a href="ode.html#cb40-109" aria-hidden="true" tabindex="-1"></a>  rr_e_cigarette_transitions[<span class="dv">2</span>,,,,] <span class="ot">&lt;-</span> rr_e_cigarette_cessation</span>
<span id="cb40-110"><a href="ode.html#cb40-110" aria-hidden="true" tabindex="-1"></a>  rr_e_cigarette_transitions[<span class="dv">3</span>,,,,] <span class="ot">&lt;-</span> rr_e_cigarette_reinstatement</span>
<span id="cb40-111"><a href="ode.html#cb40-111" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-112"><a href="ode.html#cb40-112" aria-hidden="true" tabindex="-1"></a>  cig_out <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb40-113"><a href="ode.html#cb40-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-114"><a href="ode.html#cb40-114" aria-hidden="true" tabindex="-1"></a>  cig_in <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb40-115"><a href="ode.html#cb40-115" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-116"><a href="ode.html#cb40-116" aria-hidden="true" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb40-117"><a href="ode.html#cb40-117" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Finally need death parameters</span></span>
<span id="cb40-118"><a href="ode.html#cb40-118" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Will use CDC life tables to get death https://www.cdc.gov/nchs/products/life_tables.htm</span></span>
<span id="cb40-119"><a href="ode.html#cb40-119" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Will stratify death rates by age and sex</span></span>
<span id="cb40-120"><a href="ode.html#cb40-120" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Death rate is computed as follows:</span></span>
<span id="cb40-121"><a href="ode.html#cb40-121" aria-hidden="true" tabindex="-1"></a>  <span class="do">## First, the probability of death between ages X and X+1 were extracted from the lifetable</span></span>
<span id="cb40-122"><a href="ode.html#cb40-122" aria-hidden="true" tabindex="-1"></a>  <span class="do">## For each age range, the median probability was sampled</span></span>
<span id="cb40-123"><a href="ode.html#cb40-123" aria-hidden="true" tabindex="-1"></a>  <span class="do">## For the over 65 group, we exlcuded the &gt;100 category because the probability of death was 100%</span></span>
<span id="cb40-124"><a href="ode.html#cb40-124" aria-hidden="true" tabindex="-1"></a>  <span class="do">## The probabilities were then converted into rates using the formula: rate = -ln(1 - probability)</span></span>
<span id="cb40-125"><a href="ode.html#cb40-125" aria-hidden="true" tabindex="-1"></a>  <span class="do">## </span></span>
<span id="cb40-126"><a href="ode.html#cb40-126" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-127"><a href="ode.html#cb40-127" aria-hidden="true" tabindex="-1"></a>  death_rates <span class="ot">&lt;-</span> <span class="fu">toArray</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,sex_types<span class="sc">*</span>age_types), <span class="at">dim =</span> <span class="fu">c</span>(sex_types,age_types))</span>
<span id="cb40-128"><a href="ode.html#cb40-128" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-129"><a href="ode.html#cb40-129" aria-hidden="true" tabindex="-1"></a>  <span class="do">## For Men</span></span>
<span id="cb40-130"><a href="ode.html#cb40-130" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-131"><a href="ode.html#cb40-131" aria-hidden="true" tabindex="-1"></a>  <span class="do">##-ln(1 - probability)</span></span>
<span id="cb40-132"><a href="ode.html#cb40-132" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-133"><a href="ode.html#cb40-133" aria-hidden="true" tabindex="-1"></a>  death_rates[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(<span class="fl">0.001286</span>, <span class="fl">0.001835</span>, <span class="fl">0.002426</span>, <span class="fl">0.004763</span>, <span class="fl">0.011045</span>, <span class="fl">0.069452</span>))</span>
<span id="cb40-134"><a href="ode.html#cb40-134" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-135"><a href="ode.html#cb40-135" aria-hidden="true" tabindex="-1"></a>  <span class="do">## For Women</span></span>
<span id="cb40-136"><a href="ode.html#cb40-136" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-137"><a href="ode.html#cb40-137" aria-hidden="true" tabindex="-1"></a>  death_rates[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(<span class="fl">0.000471</span>, <span class="fl">0.000801</span>, <span class="fl">0.001373</span>, <span class="fl">0.002971</span>, <span class="fl">0.006655</span>, <span class="fl">0.051681</span>))</span>
<span id="cb40-138"><a href="ode.html#cb40-138" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-139"><a href="ode.html#cb40-139" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Entries Multiplier</span></span>
<span id="cb40-140"><a href="ode.html#cb40-140" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-141"><a href="ode.html#cb40-141" aria-hidden="true" tabindex="-1"></a>  <span class="do">## We only want entries to occur for the 18-24 group</span></span>
<span id="cb40-142"><a href="ode.html#cb40-142" aria-hidden="true" tabindex="-1"></a>  <span class="do">## so we use entries[age] to get the appropriate multiplier</span></span>
<span id="cb40-143"><a href="ode.html#cb40-143" aria-hidden="true" tabindex="-1"></a>  <span class="do">## we return 1 for 18-24 and 0 for all other ages</span></span>
<span id="cb40-144"><a href="ode.html#cb40-144" aria-hidden="true" tabindex="-1"></a>  entries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb40-145"><a href="ode.html#cb40-145" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-146"><a href="ode.html#cb40-146" aria-hidden="true" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb40-147"><a href="ode.html#cb40-147" aria-hidden="true" tabindex="-1"></a>  <span class="do">## We also need excess mortality related to cigarette use</span></span>
<span id="cb40-148"><a href="ode.html#cb40-148" aria-hidden="true" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb40-149"><a href="ode.html#cb40-149" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-150"><a href="ode.html#cb40-150" aria-hidden="true" tabindex="-1"></a>  excess_cigarette_death_RR <span class="ot">&lt;-</span> <span class="fu">toArray</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,sex_types<span class="sc">*</span>cigarette_types), <span class="at">dim =</span> <span class="fu">c</span>(sex_types,cigarette_types))</span>
<span id="cb40-151"><a href="ode.html#cb40-151" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-152"><a href="ode.html#cb40-152" aria-hidden="true" tabindex="-1"></a>  excess_cigarette_death_RR[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">2.24</span>,<span class="fl">1.30</span>) </span>
<span id="cb40-153"><a href="ode.html#cb40-153" aria-hidden="true" tabindex="-1"></a>  excess_cigarette_death_RR[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">2.29</span>,<span class="fl">1.35</span>)</span>
<span id="cb40-154"><a href="ode.html#cb40-154" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-155"><a href="ode.html#cb40-155" aria-hidden="true" tabindex="-1"></a>  <span class="do">## This is the object which will contain all of the ODEs</span></span>
<span id="cb40-156"><a href="ode.html#cb40-156" aria-hidden="true" tabindex="-1"></a>  <span class="do">## It is the same size as the states matrix</span></span>
<span id="cb40-157"><a href="ode.html#cb40-157" aria-hidden="true" tabindex="-1"></a>  ODEs <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">dim =</span> <span class="fu">c</span>(sex_types,age_types,cigarette_types,e_cigarette_types,income_types))</span>
<span id="cb40-158"><a href="ode.html#cb40-158" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-159"><a href="ode.html#cb40-159" aria-hidden="true" tabindex="-1"></a>  sex <span class="ot">&lt;-</span> parameters[<span class="dv">2978</span>]</span>
<span id="cb40-160"><a href="ode.html#cb40-160" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-161"><a href="ode.html#cb40-161" aria-hidden="true" tabindex="-1"></a>  <span class="do">## for entries we first need the total birth number</span></span>
<span id="cb40-162"><a href="ode.html#cb40-162" aria-hidden="true" tabindex="-1"></a>  growth_rate <span class="ot">&lt;-</span> parameters[<span class="dv">3060</span>]</span>
<span id="cb40-163"><a href="ode.html#cb40-163" aria-hidden="true" tabindex="-1"></a>  entry_population_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">toVector</span>(states))<span class="sc">*</span>growth_rate</span>
<span id="cb40-164"><a href="ode.html#cb40-164" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-165"><a href="ode.html#cb40-165" aria-hidden="true" tabindex="-1"></a>  younglings <span class="ot">&lt;-</span> <span class="fu">toArray</span>(parameters[<span class="dv">2979</span><span class="sc">:</span><span class="dv">3056</span>], <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">13</span>))</span>
<span id="cb40-166"><a href="ode.html#cb40-166" aria-hidden="true" tabindex="-1"></a>  younglings <span class="ot">&lt;-</span> younglings<span class="sc">*</span>entry_population_total</span>
<span id="cb40-167"><a href="ode.html#cb40-167" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-168"><a href="ode.html#cb40-168" aria-hidden="true" tabindex="-1"></a>  youngling_mult <span class="ot">&lt;-</span> parameters[<span class="dv">3057</span><span class="sc">:</span><span class="dv">3059</span>]</span>
<span id="cb40-169"><a href="ode.html#cb40-169" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-170"><a href="ode.html#cb40-170" aria-hidden="true" tabindex="-1"></a>  not_sex <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb40-171"><a href="ode.html#cb40-171" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(sex <span class="sc">==</span> <span class="dv">1</span>){not_sex <span class="ot">&lt;-</span> <span class="dv">2</span>}</span>
<span id="cb40-172"><a href="ode.html#cb40-172" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-173"><a href="ode.html#cb40-173" aria-hidden="true" tabindex="-1"></a>  ODEs[not_sex,,,,] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-174"><a href="ode.html#cb40-174" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-175"><a href="ode.html#cb40-175" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-176"><a href="ode.html#cb40-176" aria-hidden="true" tabindex="-1"></a>  <span class="co">#e_cigarette &lt;- 1</span></span>
<span id="cb40-177"><a href="ode.html#cb40-177" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(income <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>income_types){</span>
<span id="cb40-178"><a href="ode.html#cb40-178" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-179"><a href="ode.html#cb40-179" aria-hidden="true" tabindex="-1"></a>    sources <span class="ot">&lt;-</span> income_transition_sources[[income]]</span>
<span id="cb40-180"><a href="ode.html#cb40-180" aria-hidden="true" tabindex="-1"></a>    landings <span class="ot">&lt;-</span> income_transition_landings[[income]]</span>
<span id="cb40-181"><a href="ode.html#cb40-181" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-182"><a href="ode.html#cb40-182" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-183"><a href="ode.html#cb40-183" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(e_cigarette <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>e_cigarette_types){</span>
<span id="cb40-184"><a href="ode.html#cb40-184" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-185"><a href="ode.html#cb40-185" aria-hidden="true" tabindex="-1"></a>      e_cig_in <span class="ot">&lt;-</span> cig_in[[e_cigarette]]</span>
<span id="cb40-186"><a href="ode.html#cb40-186" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-187"><a href="ode.html#cb40-187" aria-hidden="true" tabindex="-1"></a>      <span class="co"># for(sex in 1:sex_types){</span></span>
<span id="cb40-188"><a href="ode.html#cb40-188" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(age <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>age_types){</span>
<span id="cb40-189"><a href="ode.html#cb40-189" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-190"><a href="ode.html#cb40-190" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-191"><a href="ode.html#cb40-191" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-192"><a href="ode.html#cb40-192" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-193"><a href="ode.html#cb40-193" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-194"><a href="ode.html#cb40-194" aria-hidden="true" tabindex="-1"></a>        <span class="do">##</span></span>
<span id="cb40-195"><a href="ode.html#cb40-195" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Cigarette State 1: Never Smoker</span></span>
<span id="cb40-196"><a href="ode.html#cb40-196" aria-hidden="true" tabindex="-1"></a>        <span class="do">##</span></span>
<span id="cb40-197"><a href="ode.html#cb40-197" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-198"><a href="ode.html#cb40-198" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-199"><a href="ode.html#cb40-199" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Age In</span></span>
<span id="cb40-200"><a href="ode.html#cb40-200" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-201"><a href="ode.html#cb40-201" aria-hidden="true" tabindex="-1"></a>        <span class="do">##</span></span>
<span id="cb40-202"><a href="ode.html#cb40-202" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Need to capture two cases: </span></span>
<span id="cb40-203"><a href="ode.html#cb40-203" aria-hidden="true" tabindex="-1"></a>        <span class="do">## For the youngest age group (age == 1), in which people can&#39;t age in</span></span>
<span id="cb40-204"><a href="ode.html#cb40-204" aria-hidden="true" tabindex="-1"></a>        <span class="do">## All other age groups</span></span>
<span id="cb40-205"><a href="ode.html#cb40-205" aria-hidden="true" tabindex="-1"></a>        <span class="do">##</span></span>
<span id="cb40-206"><a href="ode.html#cb40-206" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ageIn &lt;- 0</span></span>
<span id="cb40-207"><a href="ode.html#cb40-207" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-208"><a href="ode.html#cb40-208" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if(age &gt; 1){</span></span>
<span id="cb40-209"><a href="ode.html#cb40-209" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## the number of people who transition in are those in the younger age group</span></span>
<span id="cb40-210"><a href="ode.html#cb40-210" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## times the proportion of people who will age out</span></span>
<span id="cb40-211"><a href="ode.html#cb40-211" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ageIn &lt;- states[sex,age - 1,1,e_cigarette,income]*age_transitions[age - 1]</span></span>
<span id="cb40-212"><a href="ode.html#cb40-212" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else if(age == 1){</span></span>
<span id="cb40-213"><a href="ode.html#cb40-213" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-214"><a href="ode.html#cb40-214" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-215"><a href="ode.html#cb40-215" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## This is where we can include &quot;births&quot; into the model</span></span>
<span id="cb40-216"><a href="ode.html#cb40-216" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-217"><a href="ode.html#cb40-217" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-218"><a href="ode.html#cb40-218" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }</span></span>
<span id="cb40-219"><a href="ode.html#cb40-219" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-220"><a href="ode.html#cb40-220" aria-hidden="true" tabindex="-1"></a>        ageIn <span class="ot">&lt;-</span> states[sex,age_in[age] <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">1</span> , e_cigarette,income]<span class="sc">*</span><span class="fu">c</span>(<span class="dv">0</span>,age_transitions)[age] <span class="sc">+</span> entries[age]<span class="sc">*</span>younglings[sex,e_cigarette,income]<span class="sc">*</span>youngling_mult[<span class="dv">1</span>]</span>
<span id="cb40-221"><a href="ode.html#cb40-221" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-222"><a href="ode.html#cb40-222" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Age Out</span></span>
<span id="cb40-223"><a href="ode.html#cb40-223" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-224"><a href="ode.html#cb40-224" aria-hidden="true" tabindex="-1"></a>        <span class="do">##</span></span>
<span id="cb40-225"><a href="ode.html#cb40-225" aria-hidden="true" tabindex="-1"></a>        <span class="do">## SImilarly with aging out, we must consider an edge case</span></span>
<span id="cb40-226"><a href="ode.html#cb40-226" aria-hidden="true" tabindex="-1"></a>        <span class="do">## People in the oldest age group (age == 6) can&#39;t age out</span></span>
<span id="cb40-227"><a href="ode.html#cb40-227" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-228"><a href="ode.html#cb40-228" aria-hidden="true" tabindex="-1"></a>        <span class="co">#ageOut &lt;- 0</span></span>
<span id="cb40-229"><a href="ode.html#cb40-229" aria-hidden="true" tabindex="-1"></a>        <span class="co">#if(age &lt; 6){</span></span>
<span id="cb40-230"><a href="ode.html#cb40-230" aria-hidden="true" tabindex="-1"></a>        <span class="do">## The number of people who will leave is the </span></span>
<span id="cb40-231"><a href="ode.html#cb40-231" aria-hidden="true" tabindex="-1"></a>        <span class="do">## the number of people in the compartment times</span></span>
<span id="cb40-232"><a href="ode.html#cb40-232" aria-hidden="true" tabindex="-1"></a>        <span class="do">## the proportion of people who will age out of this group</span></span>
<span id="cb40-233"><a href="ode.html#cb40-233" aria-hidden="true" tabindex="-1"></a>        ageOut <span class="ot">&lt;-</span> states[sex,age,<span class="dv">1</span>,e_cigarette,income]<span class="sc">*</span>age_transitions[age]</span>
<span id="cb40-234"><a href="ode.html#cb40-234" aria-hidden="true" tabindex="-1"></a>        <span class="co">#}</span></span>
<span id="cb40-235"><a href="ode.html#cb40-235" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-236"><a href="ode.html#cb40-236" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Income In</span></span>
<span id="cb40-237"><a href="ode.html#cb40-237" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-238"><a href="ode.html#cb40-238" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Because of the staging compartments in the model</span></span>
<span id="cb40-239"><a href="ode.html#cb40-239" aria-hidden="true" tabindex="-1"></a>        <span class="do">## This leads to a rather complicated set of transitions</span></span>
<span id="cb40-240"><a href="ode.html#cb40-240" aria-hidden="true" tabindex="-1"></a>        <span class="do">## FOr income_level X, the income_transition_sources object</span></span>
<span id="cb40-241"><a href="ode.html#cb40-241" aria-hidden="true" tabindex="-1"></a>        <span class="do">## contains a vector of all the compartments from which someone</span></span>
<span id="cb40-242"><a href="ode.html#cb40-242" aria-hidden="true" tabindex="-1"></a>        <span class="do">## can transition into X from</span></span>
<span id="cb40-243"><a href="ode.html#cb40-243" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-244"><a href="ode.html#cb40-244" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-245"><a href="ode.html#cb40-245" aria-hidden="true" tabindex="-1"></a>        incomeIn <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-246"><a href="ode.html#cb40-246" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-247"><a href="ode.html#cb40-247" aria-hidden="true" tabindex="-1"></a>        <span class="do">## In order to calculate the number of people who transition into</span></span>
<span id="cb40-248"><a href="ode.html#cb40-248" aria-hidden="true" tabindex="-1"></a>        <span class="do">## the given compartment based on income, we loop through all</span></span>
<span id="cb40-249"><a href="ode.html#cb40-249" aria-hidden="true" tabindex="-1"></a>        <span class="do">## the compartments that people can transition from</span></span>
<span id="cb40-250"><a href="ode.html#cb40-250" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(income_level <span class="cf">in</span> sources){</span>
<span id="cb40-251"><a href="ode.html#cb40-251" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-252"><a href="ode.html#cb40-252" aria-hidden="true" tabindex="-1"></a>          <span class="do">## First, we create a modifier variable</span></span>
<span id="cb40-253"><a href="ode.html#cb40-253" aria-hidden="true" tabindex="-1"></a>          <span class="do">## It is set to one in case this is not a staging compartment</span></span>
<span id="cb40-254"><a href="ode.html#cb40-254" aria-hidden="true" tabindex="-1"></a>          <span class="do">## If it is a staging compartment, then the modifier is set to the staging modifier</span></span>
<span id="cb40-255"><a href="ode.html#cb40-255" aria-hidden="true" tabindex="-1"></a>          mod <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb40-256"><a href="ode.html#cb40-256" aria-hidden="true" tabindex="-1"></a>          <span class="do">## Can check if it is a staging compartment by seeing if the income_level</span></span>
<span id="cb40-257"><a href="ode.html#cb40-257" aria-hidden="true" tabindex="-1"></a>          <span class="do">## Matches up with income_5_cat[income_level] and if the income for the two compartments</span></span>
<span id="cb40-258"><a href="ode.html#cb40-258" aria-hidden="true" tabindex="-1"></a>          <span class="do">## is the same</span></span>
<span id="cb40-259"><a href="ode.html#cb40-259" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-260"><a href="ode.html#cb40-260" aria-hidden="true" tabindex="-1"></a>          <span class="do">##if(income_level != income_5_cat[income_level] &amp;&amp; income == income_5_cat[income_level]){</span></span>
<span id="cb40-261"><a href="ode.html#cb40-261" aria-hidden="true" tabindex="-1"></a>          <span class="do">##  mod &lt;- staging_modifier</span></span>
<span id="cb40-262"><a href="ode.html#cb40-262" aria-hidden="true" tabindex="-1"></a>          <span class="do">##}</span></span>
<span id="cb40-263"><a href="ode.html#cb40-263" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-264"><a href="ode.html#cb40-264" aria-hidden="true" tabindex="-1"></a>          <span class="do">## then the proportion of people who make the transition are the proportion of people</span></span>
<span id="cb40-265"><a href="ode.html#cb40-265" aria-hidden="true" tabindex="-1"></a>          <span class="do">## in the prior compartment who make the income transition</span></span>
<span id="cb40-266"><a href="ode.html#cb40-266" aria-hidden="true" tabindex="-1"></a>          <span class="do">## if it is from a staging compartment, the modifier impacts this rates</span></span>
<span id="cb40-267"><a href="ode.html#cb40-267" aria-hidden="true" tabindex="-1"></a>          incomeIn <span class="ot">&lt;-</span> incomeIn <span class="sc">+</span> states[sex,age,<span class="dv">1</span>,e_cigarette,income_level]<span class="sc">*</span>income_transitions[age,income_5_cat[income_level],income_5_cat[income]]<span class="sc">*</span>mod</span>
<span id="cb40-268"><a href="ode.html#cb40-268" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-269"><a href="ode.html#cb40-269" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb40-270"><a href="ode.html#cb40-270" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-271"><a href="ode.html#cb40-271" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Income Out</span></span>
<span id="cb40-272"><a href="ode.html#cb40-272" aria-hidden="true" tabindex="-1"></a>        incomeOut <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-273"><a href="ode.html#cb40-273" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Two cases, either someone is in a non-staging compartment (income == 1-5)</span></span>
<span id="cb40-274"><a href="ode.html#cb40-274" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Or in a staging compartment (income = 6-13)</span></span>
<span id="cb40-275"><a href="ode.html#cb40-275" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-276"><a href="ode.html#cb40-276" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(income_level <span class="cf">in</span> landings){</span>
<span id="cb40-277"><a href="ode.html#cb40-277" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-278"><a href="ode.html#cb40-278" aria-hidden="true" tabindex="-1"></a>          mod <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb40-279"><a href="ode.html#cb40-279" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-280"><a href="ode.html#cb40-280" aria-hidden="true" tabindex="-1"></a>          <span class="do">##if(income != income_5_cat[income] &amp;&amp; income_level == income_5_cat[income]){</span></span>
<span id="cb40-281"><a href="ode.html#cb40-281" aria-hidden="true" tabindex="-1"></a>          <span class="do">##   mod &lt;- staging_modifier</span></span>
<span id="cb40-282"><a href="ode.html#cb40-282" aria-hidden="true" tabindex="-1"></a>          <span class="do">##}</span></span>
<span id="cb40-283"><a href="ode.html#cb40-283" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-284"><a href="ode.html#cb40-284" aria-hidden="true" tabindex="-1"></a>          incomeOut <span class="ot">&lt;-</span> incomeOut <span class="sc">+</span> states[sex,age,<span class="dv">1</span>,e_cigarette,income]<span class="sc">*</span>income_transitions[age,income_5_cat[income],income_5_cat[income_level]]<span class="sc">*</span>mod</span>
<span id="cb40-285"><a href="ode.html#cb40-285" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-286"><a href="ode.html#cb40-286" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb40-287"><a href="ode.html#cb40-287" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-288"><a href="ode.html#cb40-288" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ## First we consider a non-staging compartment</span></span>
<span id="cb40-289"><a href="ode.html#cb40-289" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if(income == income_5_cat[income]){</span></span>
<span id="cb40-290"><a href="ode.html#cb40-290" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## The number of people who transition out is just the proportion of people</span></span>
<span id="cb40-291"><a href="ode.html#cb40-291" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Whose income changes, which is 1 - the proportion of people whose income won&#39;t change</span></span>
<span id="cb40-292"><a href="ode.html#cb40-292" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   incomeOut &lt;- states[sex,age,1,e_cigarette,income]*(1 - income_transitions[age,income,income])</span></span>
<span id="cb40-293"><a href="ode.html#cb40-293" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else{</span></span>
<span id="cb40-294"><a href="ode.html#cb40-294" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-295"><a href="ode.html#cb40-295" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Question: How do we define the transitions out of the staging compartments</span></span>
<span id="cb40-296"><a href="ode.html#cb40-296" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Is it just that everyone transitions out or is there a proportion that stays put</span></span>
<span id="cb40-297"><a href="ode.html#cb40-297" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## It seems like we need to establish a value S which captures how long people stay in these compartments</span></span>
<span id="cb40-298"><a href="ode.html#cb40-298" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-299"><a href="ode.html#cb40-299" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-300"><a href="ode.html#cb40-300" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-301"><a href="ode.html#cb40-301" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## There are two possible transitions</span></span>
<span id="cb40-302"><a href="ode.html#cb40-302" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Income level changes</span></span>
<span id="cb40-303"><a href="ode.html#cb40-303" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Income stabilization</span></span>
<span id="cb40-304"><a href="ode.html#cb40-304" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-305"><a href="ode.html#cb40-305" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-306"><a href="ode.html#cb40-306" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## First we account for income changes</span></span>
<span id="cb40-307"><a href="ode.html#cb40-307" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Like in the first case, this is just the proportion of peoples whose income changes</span></span>
<span id="cb40-308"><a href="ode.html#cb40-308" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   incomeOut &lt;- states[sex,age,1,e_cigarette,income]*(1 - income_transitions[age,income_5_cat[income],income_5_cat[income]])</span></span>
<span id="cb40-309"><a href="ode.html#cb40-309" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-310"><a href="ode.html#cb40-310" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Second we account for income stabilization</span></span>
<span id="cb40-311"><a href="ode.html#cb40-311" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## The transition out is thus the proportion of people in the compartment whose income</span></span>
<span id="cb40-312"><a href="ode.html#cb40-312" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## stays the same times the staging modifier. If the staging modifier is 0.5 then</span></span>
<span id="cb40-313"><a href="ode.html#cb40-313" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## half of the people whose income is stabilized would leave and go to the non-staging comaprtment</span></span>
<span id="cb40-314"><a href="ode.html#cb40-314" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   incomeOut &lt;- incomeOut + states[sex,age,1,e_cigarette,income]*income_transitions[age,income_5_cat[income],income_5_cat[income]]*staging_modifier</span></span>
<span id="cb40-315"><a href="ode.html#cb40-315" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-316"><a href="ode.html#cb40-316" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }</span></span>
<span id="cb40-317"><a href="ode.html#cb40-317" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-318"><a href="ode.html#cb40-318" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Cigarette In</span></span>
<span id="cb40-319"><a href="ode.html#cb40-319" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-320"><a href="ode.html#cb40-320" aria-hidden="true" tabindex="-1"></a>        <span class="do">## There is no cigarette in transition for Never Smokers</span></span>
<span id="cb40-321"><a href="ode.html#cb40-321" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-322"><a href="ode.html#cb40-322" aria-hidden="true" tabindex="-1"></a>        <span class="do">## cigarette Out</span></span>
<span id="cb40-323"><a href="ode.html#cb40-323" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-324"><a href="ode.html#cb40-324" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Never to Cigarette Smoker -- Initiation</span></span>
<span id="cb40-325"><a href="ode.html#cb40-325" aria-hidden="true" tabindex="-1"></a>        cigaretteOut <span class="ot">&lt;-</span> states[sex,age,<span class="dv">1</span>,e_cigarette,income]<span class="sc">*</span>(cigarette_transitions[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>rr_cigarette_initiation[sex,age,e_cigarette,income])</span>
<span id="cb40-326"><a href="ode.html#cb40-326" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-327"><a href="ode.html#cb40-327" aria-hidden="true" tabindex="-1"></a>        <span class="do">## E-Cigarette Transitions</span></span>
<span id="cb40-328"><a href="ode.html#cb40-328" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-329"><a href="ode.html#cb40-329" aria-hidden="true" tabindex="-1"></a>        <span class="do">## e_cigarette in</span></span>
<span id="cb40-330"><a href="ode.html#cb40-330" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-331"><a href="ode.html#cb40-331" aria-hidden="true" tabindex="-1"></a>        e_cigaretteIn <span class="ot">&lt;-</span> states[sex,age,<span class="dv">1</span>,<span class="dv">1</span>,income]<span class="sc">*</span>(e_cigarette_transitions[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>rr_e_cigarette_initiation[sex,age,<span class="dv">1</span>,income])<span class="sc">*</span>e_cig_in[<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb40-332"><a href="ode.html#cb40-332" aria-hidden="true" tabindex="-1"></a>          states[sex,age,<span class="dv">1</span>,<span class="dv">2</span>,income]<span class="sc">*</span>(e_cigarette_transitions[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">*</span>rr_e_cigarette_cessation[sex,age,<span class="dv">1</span>,income])<span class="sc">*</span>e_cig_in[<span class="dv">2</span>] <span class="sc">+</span></span>
<span id="cb40-333"><a href="ode.html#cb40-333" aria-hidden="true" tabindex="-1"></a>          states[sex,age,<span class="dv">1</span>,<span class="dv">3</span>,income]<span class="sc">*</span>(e_cigarette_transitions[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">*</span>rr_e_cigarette_reinstatement[sex,age,<span class="dv">1</span>,income])<span class="sc">*</span>e_cig_in[<span class="dv">3</span>]</span>
<span id="cb40-334"><a href="ode.html#cb40-334" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-335"><a href="ode.html#cb40-335" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if(e_cigarette == 1){</span></span>
<span id="cb40-336"><a href="ode.html#cb40-336" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-337"><a href="ode.html#cb40-337" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## never e-cig smoker and therefore there is no in flow</span></span>
<span id="cb40-338"><a href="ode.html#cb40-338" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-339"><a href="ode.html#cb40-339" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else </span></span>
<span id="cb40-340"><a href="ode.html#cb40-340" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-341"><a href="ode.html#cb40-341" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   if(e_cigarette == 2){</span></span>
<span id="cb40-342"><a href="ode.html#cb40-342" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-343"><a href="ode.html#cb40-343" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for initiation 1 - 2</span></span>
<span id="cb40-344"><a href="ode.html#cb40-344" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-345"><a href="ode.html#cb40-345" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteIn &lt;- e_cigaretteIn + states[sex,age,1,1,income]*(e_cigarette_transitions[1,2]*rr_e_cigarette_initiation[sex,age,1,income])</span></span>
<span id="cb40-346"><a href="ode.html#cb40-346" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-347"><a href="ode.html#cb40-347" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for reinstatement</span></span>
<span id="cb40-348"><a href="ode.html#cb40-348" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-349"><a href="ode.html#cb40-349" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteIn &lt;- e_cigaretteIn + states[sex,age,1,3,income]*(e_cigarette_transitions[3,2]*rr_e_cigarette_reinstatement[sex,age,1,income])</span></span>
<span id="cb40-350"><a href="ode.html#cb40-350" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-351"><a href="ode.html#cb40-351" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else if(e_cigarette == 3){</span></span>
<span id="cb40-352"><a href="ode.html#cb40-352" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-353"><a href="ode.html#cb40-353" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for cessation</span></span>
<span id="cb40-354"><a href="ode.html#cb40-354" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-355"><a href="ode.html#cb40-355" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteIn &lt;- e_cigaretteIn + states[sex,age,1,2,income]*(e_cigarette_transitions[2,3]*rr_e_cigarette_cessation[sex,age,1,income])</span></span>
<span id="cb40-356"><a href="ode.html#cb40-356" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-357"><a href="ode.html#cb40-357" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }</span></span>
<span id="cb40-358"><a href="ode.html#cb40-358" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-359"><a href="ode.html#cb40-359" aria-hidden="true" tabindex="-1"></a>        <span class="do">## e_cigarette out</span></span>
<span id="cb40-360"><a href="ode.html#cb40-360" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-361"><a href="ode.html#cb40-361" aria-hidden="true" tabindex="-1"></a>        e_cigaretteOut <span class="ot">&lt;-</span>  states[sex,age,<span class="dv">1</span>,e_cigarette,income]<span class="sc">*</span>(e_cigarette_transitions[e_cigarette,cig_out[e_cigarette]]<span class="sc">*</span>rr_e_cigarette_transitions[e_cigarette,sex,age,<span class="dv">1</span>,income])</span>
<span id="cb40-362"><a href="ode.html#cb40-362" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-363"><a href="ode.html#cb40-363" aria-hidden="true" tabindex="-1"></a>        <span class="co"># e_cigaretteOut &lt;- 0</span></span>
<span id="cb40-364"><a href="ode.html#cb40-364" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-365"><a href="ode.html#cb40-365" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if(e_cigarette == 1){</span></span>
<span id="cb40-366"><a href="ode.html#cb40-366" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-367"><a href="ode.html#cb40-367" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for initiation</span></span>
<span id="cb40-368"><a href="ode.html#cb40-368" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-369"><a href="ode.html#cb40-369" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteOut &lt;- e_cigaretteOut + states[sex,age,1,e_cigarette,income]*(e_cigarette_transitions[1,2]*rr_e_cigarette_initiation[sex,age,1,income])</span></span>
<span id="cb40-370"><a href="ode.html#cb40-370" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-371"><a href="ode.html#cb40-371" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else if(e_cigarette == 2){</span></span>
<span id="cb40-372"><a href="ode.html#cb40-372" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-373"><a href="ode.html#cb40-373" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for cessation</span></span>
<span id="cb40-374"><a href="ode.html#cb40-374" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-375"><a href="ode.html#cb40-375" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteOut &lt;- e_cigaretteOut + states[sex,age,1,e_cigarette,income]*(e_cigarette_transitions[2,3]*rr_e_cigarette_cessation[sex,age,1,income])</span></span>
<span id="cb40-376"><a href="ode.html#cb40-376" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-377"><a href="ode.html#cb40-377" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else if(e_cigarette == 3){</span></span>
<span id="cb40-378"><a href="ode.html#cb40-378" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-379"><a href="ode.html#cb40-379" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for reinstatement</span></span>
<span id="cb40-380"><a href="ode.html#cb40-380" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-381"><a href="ode.html#cb40-381" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteOut &lt;- e_cigaretteOut + states[sex,age,1,e_cigarette,income]*(e_cigarette_transitions[3,2]*rr_e_cigarette_reinstatement[sex,age,1,income])</span></span>
<span id="cb40-382"><a href="ode.html#cb40-382" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-383"><a href="ode.html#cb40-383" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }</span></span>
<span id="cb40-384"><a href="ode.html#cb40-384" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-385"><a href="ode.html#cb40-385" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Death</span></span>
<span id="cb40-386"><a href="ode.html#cb40-386" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-387"><a href="ode.html#cb40-387" aria-hidden="true" tabindex="-1"></a>        death <span class="ot">&lt;-</span> states[sex,age,<span class="dv">1</span>,e_cigarette,income]<span class="sc">*</span>death_rates[sex,age]<span class="sc">*</span>excess_cigarette_death_RR[sex,<span class="dv">1</span>] <span class="do">## not implemented yet</span></span>
<span id="cb40-388"><a href="ode.html#cb40-388" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-389"><a href="ode.html#cb40-389" aria-hidden="true" tabindex="-1"></a>        <span class="do">## ODE 1</span></span>
<span id="cb40-390"><a href="ode.html#cb40-390" aria-hidden="true" tabindex="-1"></a>        ODEs[sex,age, <span class="dv">1</span>, e_cigarette, income] <span class="ot">&lt;-</span> ageIn <span class="sc">-</span> ageOut <span class="sc">+</span> incomeIn <span class="sc">-</span> incomeOut <span class="sc">+</span> e_cigaretteIn <span class="sc">-</span> e_cigaretteOut <span class="sc">-</span> cigaretteOut <span class="sc">-</span> death</span>
<span id="cb40-391"><a href="ode.html#cb40-391" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-392"><a href="ode.html#cb40-392" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-393"><a href="ode.html#cb40-393" aria-hidden="true" tabindex="-1"></a>        <span class="do">##</span></span>
<span id="cb40-394"><a href="ode.html#cb40-394" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Cigarette State 2: Current Smoker</span></span>
<span id="cb40-395"><a href="ode.html#cb40-395" aria-hidden="true" tabindex="-1"></a>        <span class="do">##</span></span>
<span id="cb40-396"><a href="ode.html#cb40-396" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-397"><a href="ode.html#cb40-397" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-398"><a href="ode.html#cb40-398" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Age In</span></span>
<span id="cb40-399"><a href="ode.html#cb40-399" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-400"><a href="ode.html#cb40-400" aria-hidden="true" tabindex="-1"></a>        <span class="do">##</span></span>
<span id="cb40-401"><a href="ode.html#cb40-401" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Need to capture two cases: </span></span>
<span id="cb40-402"><a href="ode.html#cb40-402" aria-hidden="true" tabindex="-1"></a>        <span class="do">## For the youngest age group (age == 1), in which people can&#39;t age in</span></span>
<span id="cb40-403"><a href="ode.html#cb40-403" aria-hidden="true" tabindex="-1"></a>        <span class="do">## All other age groups</span></span>
<span id="cb40-404"><a href="ode.html#cb40-404" aria-hidden="true" tabindex="-1"></a>        <span class="do">##</span></span>
<span id="cb40-405"><a href="ode.html#cb40-405" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ageIn &lt;- 0</span></span>
<span id="cb40-406"><a href="ode.html#cb40-406" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-407"><a href="ode.html#cb40-407" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if(age &gt; 1){</span></span>
<span id="cb40-408"><a href="ode.html#cb40-408" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## the number of people who transition in are those in the younger age group</span></span>
<span id="cb40-409"><a href="ode.html#cb40-409" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## times the proportion of people who will age out</span></span>
<span id="cb40-410"><a href="ode.html#cb40-410" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ageIn &lt;- states[sex,age - 1, 2 , e_cigarette,income]*age_transitions[age - 1]</span></span>
<span id="cb40-411"><a href="ode.html#cb40-411" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else if(age == 1){</span></span>
<span id="cb40-412"><a href="ode.html#cb40-412" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-413"><a href="ode.html#cb40-413" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-414"><a href="ode.html#cb40-414" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## This is where we can include &quot;births&quot; into the model</span></span>
<span id="cb40-415"><a href="ode.html#cb40-415" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-416"><a href="ode.html#cb40-416" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-417"><a href="ode.html#cb40-417" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }</span></span>
<span id="cb40-418"><a href="ode.html#cb40-418" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-419"><a href="ode.html#cb40-419" aria-hidden="true" tabindex="-1"></a>        ageIn <span class="ot">&lt;-</span> states[sex,age_in[age] <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">2</span> , e_cigarette,income]<span class="sc">*</span><span class="fu">c</span>(<span class="dv">0</span>,age_transitions)[age] <span class="sc">+</span> entries[age]<span class="sc">*</span>younglings[sex,e_cigarette,income]<span class="sc">*</span>youngling_mult[<span class="dv">2</span>]</span>
<span id="cb40-420"><a href="ode.html#cb40-420" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-421"><a href="ode.html#cb40-421" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Age Out</span></span>
<span id="cb40-422"><a href="ode.html#cb40-422" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-423"><a href="ode.html#cb40-423" aria-hidden="true" tabindex="-1"></a>        <span class="do">##</span></span>
<span id="cb40-424"><a href="ode.html#cb40-424" aria-hidden="true" tabindex="-1"></a>        <span class="do">## SImilarly with aging out, we must consider an edge case</span></span>
<span id="cb40-425"><a href="ode.html#cb40-425" aria-hidden="true" tabindex="-1"></a>        <span class="do">## People in the oldest age group (age == 6) can&#39;t age out</span></span>
<span id="cb40-426"><a href="ode.html#cb40-426" aria-hidden="true" tabindex="-1"></a>        <span class="co">#ageOut &lt;- 0</span></span>
<span id="cb40-427"><a href="ode.html#cb40-427" aria-hidden="true" tabindex="-1"></a>        <span class="co">#if(age &lt; 6){</span></span>
<span id="cb40-428"><a href="ode.html#cb40-428" aria-hidden="true" tabindex="-1"></a>        <span class="do">## The number of people who will leave is the </span></span>
<span id="cb40-429"><a href="ode.html#cb40-429" aria-hidden="true" tabindex="-1"></a>        <span class="do">## the number of people in the compartment times</span></span>
<span id="cb40-430"><a href="ode.html#cb40-430" aria-hidden="true" tabindex="-1"></a>        <span class="do">## the proportion of people who will age out of this group</span></span>
<span id="cb40-431"><a href="ode.html#cb40-431" aria-hidden="true" tabindex="-1"></a>        ageOut <span class="ot">&lt;-</span> states[sex,age,<span class="dv">2</span>,e_cigarette,income]<span class="sc">*</span>age_transitions[age]</span>
<span id="cb40-432"><a href="ode.html#cb40-432" aria-hidden="true" tabindex="-1"></a>        <span class="co">#}</span></span>
<span id="cb40-433"><a href="ode.html#cb40-433" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-434"><a href="ode.html#cb40-434" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Income In</span></span>
<span id="cb40-435"><a href="ode.html#cb40-435" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-436"><a href="ode.html#cb40-436" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Because of the staging compartments in the model</span></span>
<span id="cb40-437"><a href="ode.html#cb40-437" aria-hidden="true" tabindex="-1"></a>        <span class="do">## This leads to a rather complicated set of transitions</span></span>
<span id="cb40-438"><a href="ode.html#cb40-438" aria-hidden="true" tabindex="-1"></a>        <span class="do">## FOr income_level X, the income_transition_sources object</span></span>
<span id="cb40-439"><a href="ode.html#cb40-439" aria-hidden="true" tabindex="-1"></a>        <span class="do">## contains a vector of all the compartments from which someone</span></span>
<span id="cb40-440"><a href="ode.html#cb40-440" aria-hidden="true" tabindex="-1"></a>        <span class="do">## can transition into X from</span></span>
<span id="cb40-441"><a href="ode.html#cb40-441" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-442"><a href="ode.html#cb40-442" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-443"><a href="ode.html#cb40-443" aria-hidden="true" tabindex="-1"></a>        incomeIn <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-444"><a href="ode.html#cb40-444" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-445"><a href="ode.html#cb40-445" aria-hidden="true" tabindex="-1"></a>        <span class="do">## In order to calculate the number of people who transition into</span></span>
<span id="cb40-446"><a href="ode.html#cb40-446" aria-hidden="true" tabindex="-1"></a>        <span class="do">## the given compartment based on income, we loop through all</span></span>
<span id="cb40-447"><a href="ode.html#cb40-447" aria-hidden="true" tabindex="-1"></a>        <span class="do">## the compartments that people can transition from</span></span>
<span id="cb40-448"><a href="ode.html#cb40-448" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(income_level <span class="cf">in</span> sources){</span>
<span id="cb40-449"><a href="ode.html#cb40-449" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-450"><a href="ode.html#cb40-450" aria-hidden="true" tabindex="-1"></a>          <span class="do">## First, we create a modifier variable</span></span>
<span id="cb40-451"><a href="ode.html#cb40-451" aria-hidden="true" tabindex="-1"></a>          <span class="do">## It is set to one in case this is not a staging compartment</span></span>
<span id="cb40-452"><a href="ode.html#cb40-452" aria-hidden="true" tabindex="-1"></a>          <span class="do">## If it is a staging compartment, then the modifier is set to the staging modifier</span></span>
<span id="cb40-453"><a href="ode.html#cb40-453" aria-hidden="true" tabindex="-1"></a>          mod <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb40-454"><a href="ode.html#cb40-454" aria-hidden="true" tabindex="-1"></a>          <span class="do">## Can check if it is a staging compartment by seeing if the income_level</span></span>
<span id="cb40-455"><a href="ode.html#cb40-455" aria-hidden="true" tabindex="-1"></a>          <span class="do">## Matches up with income_5_cat[income_level] and if the income for the two compartments</span></span>
<span id="cb40-456"><a href="ode.html#cb40-456" aria-hidden="true" tabindex="-1"></a>          <span class="do">## is the same</span></span>
<span id="cb40-457"><a href="ode.html#cb40-457" aria-hidden="true" tabindex="-1"></a>          <span class="do">##if(income_level != income_5_cat[income_level] &amp;&amp; income == income_5_cat[income_level]){</span></span>
<span id="cb40-458"><a href="ode.html#cb40-458" aria-hidden="true" tabindex="-1"></a>          <span class="do">## mod &lt;- staging_modifier</span></span>
<span id="cb40-459"><a href="ode.html#cb40-459" aria-hidden="true" tabindex="-1"></a>          <span class="do">##}</span></span>
<span id="cb40-460"><a href="ode.html#cb40-460" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-461"><a href="ode.html#cb40-461" aria-hidden="true" tabindex="-1"></a>          <span class="do">## then the proportion of people who make the transition are the proportion of people</span></span>
<span id="cb40-462"><a href="ode.html#cb40-462" aria-hidden="true" tabindex="-1"></a>          <span class="do">## in the prior compartment who make the income transition</span></span>
<span id="cb40-463"><a href="ode.html#cb40-463" aria-hidden="true" tabindex="-1"></a>          <span class="do">## if it is from a staging compartment, the modifier impacts this rates</span></span>
<span id="cb40-464"><a href="ode.html#cb40-464" aria-hidden="true" tabindex="-1"></a>          incomeIn <span class="ot">&lt;-</span> incomeIn <span class="sc">+</span> states[sex,age,<span class="dv">2</span>,e_cigarette,income_level]<span class="sc">*</span>income_transitions[age,income_5_cat[income_level],income_5_cat[income]]<span class="sc">*</span>mod</span>
<span id="cb40-465"><a href="ode.html#cb40-465" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-466"><a href="ode.html#cb40-466" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb40-467"><a href="ode.html#cb40-467" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-468"><a href="ode.html#cb40-468" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Income Out</span></span>
<span id="cb40-469"><a href="ode.html#cb40-469" aria-hidden="true" tabindex="-1"></a>        incomeOut <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-470"><a href="ode.html#cb40-470" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Two cases, either someone is in a non-staging compartment (income == 1-5)</span></span>
<span id="cb40-471"><a href="ode.html#cb40-471" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Or in a staging compartment (income = 6-13)</span></span>
<span id="cb40-472"><a href="ode.html#cb40-472" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-473"><a href="ode.html#cb40-473" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(income_level <span class="cf">in</span> landings){</span>
<span id="cb40-474"><a href="ode.html#cb40-474" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-475"><a href="ode.html#cb40-475" aria-hidden="true" tabindex="-1"></a>          mod <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb40-476"><a href="ode.html#cb40-476" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-477"><a href="ode.html#cb40-477" aria-hidden="true" tabindex="-1"></a>          <span class="do">## if(income != income_5_cat[income] &amp;&amp; income_level == income_5_cat[income]){</span></span>
<span id="cb40-478"><a href="ode.html#cb40-478" aria-hidden="true" tabindex="-1"></a>          <span class="do">##  mod &lt;- staging_modifier</span></span>
<span id="cb40-479"><a href="ode.html#cb40-479" aria-hidden="true" tabindex="-1"></a>          <span class="do">##}</span></span>
<span id="cb40-480"><a href="ode.html#cb40-480" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-481"><a href="ode.html#cb40-481" aria-hidden="true" tabindex="-1"></a>          incomeOut <span class="ot">&lt;-</span> incomeOut <span class="sc">+</span> states[sex,age,<span class="dv">2</span>,e_cigarette,income]<span class="sc">*</span>income_transitions[age,income_5_cat[income],income_5_cat[income_level]]<span class="sc">*</span>mod</span>
<span id="cb40-482"><a href="ode.html#cb40-482" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-483"><a href="ode.html#cb40-483" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb40-484"><a href="ode.html#cb40-484" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-485"><a href="ode.html#cb40-485" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ## Income Out</span></span>
<span id="cb40-486"><a href="ode.html#cb40-486" aria-hidden="true" tabindex="-1"></a>        <span class="co"># incomeOut &lt;- 0</span></span>
<span id="cb40-487"><a href="ode.html#cb40-487" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ## Two cases, either someone is in a non-staging compartment (income == 1-5)</span></span>
<span id="cb40-488"><a href="ode.html#cb40-488" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ## Or in a staging compartment (income = 6-13)</span></span>
<span id="cb40-489"><a href="ode.html#cb40-489" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-490"><a href="ode.html#cb40-490" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ## First we consider a non-staging compartment</span></span>
<span id="cb40-491"><a href="ode.html#cb40-491" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if(income == income_5_cat[income]){</span></span>
<span id="cb40-492"><a href="ode.html#cb40-492" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## The number of people who transition out is just the proportion of people</span></span>
<span id="cb40-493"><a href="ode.html#cb40-493" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Whose income changes, which is 1 - the proportion of people whose income won&#39;t change</span></span>
<span id="cb40-494"><a href="ode.html#cb40-494" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   incomeOut &lt;- states[sex,age,2,e_cigarette,income]*(1 - income_transitions[age,income,income])</span></span>
<span id="cb40-495"><a href="ode.html#cb40-495" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else{</span></span>
<span id="cb40-496"><a href="ode.html#cb40-496" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-497"><a href="ode.html#cb40-497" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Question: How do we define the transitions out of the staging compartments</span></span>
<span id="cb40-498"><a href="ode.html#cb40-498" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Is it just that everyone transitions out or is there a proportion that stays put</span></span>
<span id="cb40-499"><a href="ode.html#cb40-499" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## It seems like we need to establish a value S which captures how long people stay in these compartments</span></span>
<span id="cb40-500"><a href="ode.html#cb40-500" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-501"><a href="ode.html#cb40-501" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-502"><a href="ode.html#cb40-502" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-503"><a href="ode.html#cb40-503" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## There are two possible transitions</span></span>
<span id="cb40-504"><a href="ode.html#cb40-504" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Income level changes</span></span>
<span id="cb40-505"><a href="ode.html#cb40-505" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Income stabilization</span></span>
<span id="cb40-506"><a href="ode.html#cb40-506" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-507"><a href="ode.html#cb40-507" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-508"><a href="ode.html#cb40-508" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## First we account for income changes</span></span>
<span id="cb40-509"><a href="ode.html#cb40-509" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Like in the first case, this is just the proportion of peoples whose income changes</span></span>
<span id="cb40-510"><a href="ode.html#cb40-510" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   incomeOut &lt;- states[sex,age,2,e_cigarette,income]*(1 - income_transitions[age,income_5_cat[income],income_5_cat[income]])</span></span>
<span id="cb40-511"><a href="ode.html#cb40-511" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-512"><a href="ode.html#cb40-512" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Second we account for income stabilization</span></span>
<span id="cb40-513"><a href="ode.html#cb40-513" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## The transition out is thus the proportion of people in the compartment whose income</span></span>
<span id="cb40-514"><a href="ode.html#cb40-514" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## stays the same times the staging modifier. If the staging modifier is 0.5 then</span></span>
<span id="cb40-515"><a href="ode.html#cb40-515" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## half of the people whose income is stabilized would leave and go to the non-staging comaprtment</span></span>
<span id="cb40-516"><a href="ode.html#cb40-516" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   incomeOut &lt;- incomeOut + states[sex,age,2,e_cigarette,income]*income_transitions[age,income_5_cat[income],income_5_cat[income]]*staging_modifier</span></span>
<span id="cb40-517"><a href="ode.html#cb40-517" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-518"><a href="ode.html#cb40-518" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }</span></span>
<span id="cb40-519"><a href="ode.html#cb40-519" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-520"><a href="ode.html#cb40-520" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Cigarette In</span></span>
<span id="cb40-521"><a href="ode.html#cb40-521" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-522"><a href="ode.html#cb40-522" aria-hidden="true" tabindex="-1"></a>        cigaretteIn <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-523"><a href="ode.html#cb40-523" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-524"><a href="ode.html#cb40-524" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Need a flow for initiation</span></span>
<span id="cb40-525"><a href="ode.html#cb40-525" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-526"><a href="ode.html#cb40-526" aria-hidden="true" tabindex="-1"></a>        cigaretteIn <span class="ot">&lt;-</span> cigaretteIn <span class="sc">+</span> states[sex,age,<span class="dv">1</span>,e_cigarette,income]<span class="sc">*</span>(cigarette_transitions[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>rr_cigarette_initiation[sex,age,e_cigarette,income])</span>
<span id="cb40-527"><a href="ode.html#cb40-527" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-528"><a href="ode.html#cb40-528" aria-hidden="true" tabindex="-1"></a>        <span class="do">## need a flow for reinstatement</span></span>
<span id="cb40-529"><a href="ode.html#cb40-529" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-530"><a href="ode.html#cb40-530" aria-hidden="true" tabindex="-1"></a>        cigaretteIn <span class="ot">&lt;-</span> cigaretteIn <span class="sc">+</span> states[sex,age,<span class="dv">3</span>,e_cigarette,income]<span class="sc">*</span>(cigarette_transitions[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">*</span>rr_cigarette_reinstatement[sex,age,e_cigarette,income])</span>
<span id="cb40-531"><a href="ode.html#cb40-531" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-532"><a href="ode.html#cb40-532" aria-hidden="true" tabindex="-1"></a>        <span class="do">## cigarette Out</span></span>
<span id="cb40-533"><a href="ode.html#cb40-533" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-534"><a href="ode.html#cb40-534" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Cigarette Smoker to Former Smoker</span></span>
<span id="cb40-535"><a href="ode.html#cb40-535" aria-hidden="true" tabindex="-1"></a>        cigaretteOut <span class="ot">&lt;-</span> states[sex,age,<span class="dv">2</span>,e_cigarette,income]<span class="sc">*</span>(cigarette_transitions[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">*</span>rr_cigarette_cessation[sex,age,e_cigarette,income])</span>
<span id="cb40-536"><a href="ode.html#cb40-536" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-537"><a href="ode.html#cb40-537" aria-hidden="true" tabindex="-1"></a>        <span class="do">## E-Cigarette Transitions</span></span>
<span id="cb40-538"><a href="ode.html#cb40-538" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-539"><a href="ode.html#cb40-539" aria-hidden="true" tabindex="-1"></a>        <span class="do">## e_cigarette in</span></span>
<span id="cb40-540"><a href="ode.html#cb40-540" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-541"><a href="ode.html#cb40-541" aria-hidden="true" tabindex="-1"></a>        e_cigaretteIn <span class="ot">&lt;-</span> states[sex,age,<span class="dv">2</span>,<span class="dv">1</span>,income]<span class="sc">*</span>(e_cigarette_transitions[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>rr_e_cigarette_initiation[sex,age,<span class="dv">2</span>,income])<span class="sc">*</span>e_cig_in[<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb40-542"><a href="ode.html#cb40-542" aria-hidden="true" tabindex="-1"></a>          states[sex,age,<span class="dv">2</span>,<span class="dv">2</span>,income]<span class="sc">*</span>(e_cigarette_transitions[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">*</span>rr_e_cigarette_cessation[sex,age,<span class="dv">2</span>,income])<span class="sc">*</span>e_cig_in[<span class="dv">2</span>] <span class="sc">+</span></span>
<span id="cb40-543"><a href="ode.html#cb40-543" aria-hidden="true" tabindex="-1"></a>          states[sex,age,<span class="dv">2</span>,<span class="dv">3</span>,income]<span class="sc">*</span>(e_cigarette_transitions[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">*</span>rr_e_cigarette_reinstatement[sex,age,<span class="dv">2</span>,income])<span class="sc">*</span>e_cig_in[<span class="dv">3</span>]</span>
<span id="cb40-544"><a href="ode.html#cb40-544" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-545"><a href="ode.html#cb40-545" aria-hidden="true" tabindex="-1"></a>        <span class="co"># e_cigaretteIn &lt;- 0</span></span>
<span id="cb40-546"><a href="ode.html#cb40-546" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-547"><a href="ode.html#cb40-547" aria-hidden="true" tabindex="-1"></a>        <span class="co"># # if(e_cigarette == 1){</span></span>
<span id="cb40-548"><a href="ode.html#cb40-548" aria-hidden="true" tabindex="-1"></a>        <span class="co"># #   </span></span>
<span id="cb40-549"><a href="ode.html#cb40-549" aria-hidden="true" tabindex="-1"></a>        <span class="co"># #   ## never e-cig smoker and therefore there is no in flow</span></span>
<span id="cb40-550"><a href="ode.html#cb40-550" aria-hidden="true" tabindex="-1"></a>        <span class="co"># #   </span></span>
<span id="cb40-551"><a href="ode.html#cb40-551" aria-hidden="true" tabindex="-1"></a>        <span class="co"># # }else </span></span>
<span id="cb40-552"><a href="ode.html#cb40-552" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-553"><a href="ode.html#cb40-553" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   if(e_cigarette == 2){</span></span>
<span id="cb40-554"><a href="ode.html#cb40-554" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-555"><a href="ode.html#cb40-555" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for initiation 1 - 2</span></span>
<span id="cb40-556"><a href="ode.html#cb40-556" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-557"><a href="ode.html#cb40-557" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteIn &lt;- e_cigaretteIn + states[sex,age,2,1,income]*(e_cigarette_transitions[1,2]*rr_e_cigarette_initiation[sex,age,2,income])</span></span>
<span id="cb40-558"><a href="ode.html#cb40-558" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-559"><a href="ode.html#cb40-559" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for reinstatement</span></span>
<span id="cb40-560"><a href="ode.html#cb40-560" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-561"><a href="ode.html#cb40-561" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteIn &lt;- e_cigaretteIn + states[sex,age,2,3,income]*(e_cigarette_transitions[3,2]*rr_e_cigarette_reinstatement[sex,age,2,income])</span></span>
<span id="cb40-562"><a href="ode.html#cb40-562" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-563"><a href="ode.html#cb40-563" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else if(e_cigarette == 3){</span></span>
<span id="cb40-564"><a href="ode.html#cb40-564" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-565"><a href="ode.html#cb40-565" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for cessation</span></span>
<span id="cb40-566"><a href="ode.html#cb40-566" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-567"><a href="ode.html#cb40-567" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteIn &lt;- e_cigaretteIn + states[sex,age,2,2,income]*(e_cigarette_transitions[2,3]*rr_e_cigarette_cessation[sex,age,2,income])</span></span>
<span id="cb40-568"><a href="ode.html#cb40-568" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-569"><a href="ode.html#cb40-569" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }</span></span>
<span id="cb40-570"><a href="ode.html#cb40-570" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-571"><a href="ode.html#cb40-571" aria-hidden="true" tabindex="-1"></a>        <span class="do">## e_cigarette out</span></span>
<span id="cb40-572"><a href="ode.html#cb40-572" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-573"><a href="ode.html#cb40-573" aria-hidden="true" tabindex="-1"></a>        e_cigaretteOut <span class="ot">&lt;-</span>  states[sex,age,<span class="dv">2</span>,e_cigarette,income]<span class="sc">*</span>(e_cigarette_transitions[e_cigarette,cig_out[e_cigarette]]<span class="sc">*</span>rr_e_cigarette_transitions[e_cigarette,sex,age,<span class="dv">2</span>,income])</span>
<span id="cb40-574"><a href="ode.html#cb40-574" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-575"><a href="ode.html#cb40-575" aria-hidden="true" tabindex="-1"></a>        <span class="co"># e_cigaretteOut &lt;- 0</span></span>
<span id="cb40-576"><a href="ode.html#cb40-576" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-577"><a href="ode.html#cb40-577" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if(e_cigarette == 1){</span></span>
<span id="cb40-578"><a href="ode.html#cb40-578" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-579"><a href="ode.html#cb40-579" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for initiation</span></span>
<span id="cb40-580"><a href="ode.html#cb40-580" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-581"><a href="ode.html#cb40-581" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteOut &lt;- e_cigaretteOut + states[sex,age,2,e_cigarette,income]*(e_cigarette_transitions[1,2]*rr_e_cigarette_initiation[sex,age,2,income])</span></span>
<span id="cb40-582"><a href="ode.html#cb40-582" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-583"><a href="ode.html#cb40-583" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else if(e_cigarette == 2){</span></span>
<span id="cb40-584"><a href="ode.html#cb40-584" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-585"><a href="ode.html#cb40-585" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for cessation</span></span>
<span id="cb40-586"><a href="ode.html#cb40-586" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-587"><a href="ode.html#cb40-587" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteOut &lt;- e_cigaretteOut + states[sex,age,2,e_cigarette,income]*(e_cigarette_transitions[2,3]*rr_e_cigarette_cessation[sex,age,2,income])</span></span>
<span id="cb40-588"><a href="ode.html#cb40-588" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-589"><a href="ode.html#cb40-589" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else if(e_cigarette == 3){</span></span>
<span id="cb40-590"><a href="ode.html#cb40-590" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-591"><a href="ode.html#cb40-591" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for reinstatement</span></span>
<span id="cb40-592"><a href="ode.html#cb40-592" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-593"><a href="ode.html#cb40-593" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteOut &lt;- e_cigaretteOut + states[sex,age,2,e_cigarette,income]*(e_cigarette_transitions[3,2]*rr_e_cigarette_reinstatement[sex,age,2,income])</span></span>
<span id="cb40-594"><a href="ode.html#cb40-594" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-595"><a href="ode.html#cb40-595" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }</span></span>
<span id="cb40-596"><a href="ode.html#cb40-596" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-597"><a href="ode.html#cb40-597" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Death</span></span>
<span id="cb40-598"><a href="ode.html#cb40-598" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-599"><a href="ode.html#cb40-599" aria-hidden="true" tabindex="-1"></a>        death <span class="ot">&lt;-</span> states[sex,age,<span class="dv">2</span>,e_cigarette,income]<span class="sc">*</span>death_rates[sex,age]<span class="sc">*</span>excess_cigarette_death_RR[sex,<span class="dv">2</span>]</span>
<span id="cb40-600"><a href="ode.html#cb40-600" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-601"><a href="ode.html#cb40-601" aria-hidden="true" tabindex="-1"></a>        <span class="do">## ODE 2</span></span>
<span id="cb40-602"><a href="ode.html#cb40-602" aria-hidden="true" tabindex="-1"></a>        ODEs[sex,age, <span class="dv">2</span>, e_cigarette, income] <span class="ot">&lt;-</span> ageIn <span class="sc">-</span> ageOut <span class="sc">+</span> incomeIn <span class="sc">-</span> incomeOut <span class="sc">+</span> e_cigaretteIn <span class="sc">-</span> e_cigaretteOut <span class="sc">+</span> cigaretteIn <span class="sc">-</span> cigaretteOut <span class="sc">-</span> death</span>
<span id="cb40-603"><a href="ode.html#cb40-603" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-604"><a href="ode.html#cb40-604" aria-hidden="true" tabindex="-1"></a>        <span class="do">##</span></span>
<span id="cb40-605"><a href="ode.html#cb40-605" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Cigarette State 3: Former Smoker</span></span>
<span id="cb40-606"><a href="ode.html#cb40-606" aria-hidden="true" tabindex="-1"></a>        <span class="do">##</span></span>
<span id="cb40-607"><a href="ode.html#cb40-607" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-608"><a href="ode.html#cb40-608" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-609"><a href="ode.html#cb40-609" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Age In</span></span>
<span id="cb40-610"><a href="ode.html#cb40-610" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-611"><a href="ode.html#cb40-611" aria-hidden="true" tabindex="-1"></a>        <span class="do">##</span></span>
<span id="cb40-612"><a href="ode.html#cb40-612" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Need to capture two cases: </span></span>
<span id="cb40-613"><a href="ode.html#cb40-613" aria-hidden="true" tabindex="-1"></a>        <span class="do">## For the youngest age group (age == 1), in which people can&#39;t age in</span></span>
<span id="cb40-614"><a href="ode.html#cb40-614" aria-hidden="true" tabindex="-1"></a>        <span class="do">## All other age groups</span></span>
<span id="cb40-615"><a href="ode.html#cb40-615" aria-hidden="true" tabindex="-1"></a>        <span class="do">##</span></span>
<span id="cb40-616"><a href="ode.html#cb40-616" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ageIn &lt;- 0</span></span>
<span id="cb40-617"><a href="ode.html#cb40-617" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-618"><a href="ode.html#cb40-618" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if(age &gt; 1){</span></span>
<span id="cb40-619"><a href="ode.html#cb40-619" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## the number of people who transition in are those in the younger age group</span></span>
<span id="cb40-620"><a href="ode.html#cb40-620" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## times the proportion of people who will age out</span></span>
<span id="cb40-621"><a href="ode.html#cb40-621" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ageIn &lt;- states[sex,age - 1, 3, e_cigarette,income]*age_transitions[age - 1]</span></span>
<span id="cb40-622"><a href="ode.html#cb40-622" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else if(age == 1){</span></span>
<span id="cb40-623"><a href="ode.html#cb40-623" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-624"><a href="ode.html#cb40-624" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-625"><a href="ode.html#cb40-625" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## This is where we can include &quot;births&quot; into the model</span></span>
<span id="cb40-626"><a href="ode.html#cb40-626" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-627"><a href="ode.html#cb40-627" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-628"><a href="ode.html#cb40-628" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }</span></span>
<span id="cb40-629"><a href="ode.html#cb40-629" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-630"><a href="ode.html#cb40-630" aria-hidden="true" tabindex="-1"></a>        ageIn <span class="ot">&lt;-</span> states[sex,age_in[age] <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">3</span> , e_cigarette,income]<span class="sc">*</span><span class="fu">c</span>(<span class="dv">0</span>,age_transitions)[age] <span class="sc">+</span> entries[age]<span class="sc">*</span>younglings[sex,e_cigarette,income]<span class="sc">*</span>youngling_mult[<span class="dv">3</span>]</span>
<span id="cb40-631"><a href="ode.html#cb40-631" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-632"><a href="ode.html#cb40-632" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Age Out</span></span>
<span id="cb40-633"><a href="ode.html#cb40-633" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-634"><a href="ode.html#cb40-634" aria-hidden="true" tabindex="-1"></a>        <span class="do">##</span></span>
<span id="cb40-635"><a href="ode.html#cb40-635" aria-hidden="true" tabindex="-1"></a>        <span class="do">## SImilarly with aging out, we must consider an edge case</span></span>
<span id="cb40-636"><a href="ode.html#cb40-636" aria-hidden="true" tabindex="-1"></a>        <span class="do">## People in the oldest age group (age == 6) can&#39;t age out</span></span>
<span id="cb40-637"><a href="ode.html#cb40-637" aria-hidden="true" tabindex="-1"></a>        <span class="co">#ageOut &lt;- 0</span></span>
<span id="cb40-638"><a href="ode.html#cb40-638" aria-hidden="true" tabindex="-1"></a>        <span class="co">#if(age &lt; 6){</span></span>
<span id="cb40-639"><a href="ode.html#cb40-639" aria-hidden="true" tabindex="-1"></a>        <span class="do">## The number of people who will leave is the </span></span>
<span id="cb40-640"><a href="ode.html#cb40-640" aria-hidden="true" tabindex="-1"></a>        <span class="do">## the number of people in the compartment times</span></span>
<span id="cb40-641"><a href="ode.html#cb40-641" aria-hidden="true" tabindex="-1"></a>        <span class="do">## the proportion of people who will age out of this group</span></span>
<span id="cb40-642"><a href="ode.html#cb40-642" aria-hidden="true" tabindex="-1"></a>        ageOut <span class="ot">&lt;-</span> states[sex,age,<span class="dv">3</span>,e_cigarette,income]<span class="sc">*</span>age_transitions[age]</span>
<span id="cb40-643"><a href="ode.html#cb40-643" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }</span></span>
<span id="cb40-644"><a href="ode.html#cb40-644" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-645"><a href="ode.html#cb40-645" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Income In</span></span>
<span id="cb40-646"><a href="ode.html#cb40-646" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-647"><a href="ode.html#cb40-647" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Because of the staging compartments in the model</span></span>
<span id="cb40-648"><a href="ode.html#cb40-648" aria-hidden="true" tabindex="-1"></a>        <span class="do">## This leads to a rather complicated set of transitions</span></span>
<span id="cb40-649"><a href="ode.html#cb40-649" aria-hidden="true" tabindex="-1"></a>        <span class="do">## FOr income_level X, the income_transition_sources object</span></span>
<span id="cb40-650"><a href="ode.html#cb40-650" aria-hidden="true" tabindex="-1"></a>        <span class="do">## contains a vector of all the compartments from which someone</span></span>
<span id="cb40-651"><a href="ode.html#cb40-651" aria-hidden="true" tabindex="-1"></a>        <span class="do">## can transition into X from</span></span>
<span id="cb40-652"><a href="ode.html#cb40-652" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-653"><a href="ode.html#cb40-653" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-654"><a href="ode.html#cb40-654" aria-hidden="true" tabindex="-1"></a>        incomeIn <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-655"><a href="ode.html#cb40-655" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-656"><a href="ode.html#cb40-656" aria-hidden="true" tabindex="-1"></a>        <span class="do">## In order to calculate the number of people who transition into</span></span>
<span id="cb40-657"><a href="ode.html#cb40-657" aria-hidden="true" tabindex="-1"></a>        <span class="do">## the given compartment based on income, we loop through all</span></span>
<span id="cb40-658"><a href="ode.html#cb40-658" aria-hidden="true" tabindex="-1"></a>        <span class="do">## the compartments that people can transition from</span></span>
<span id="cb40-659"><a href="ode.html#cb40-659" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(income_level <span class="cf">in</span> sources){</span>
<span id="cb40-660"><a href="ode.html#cb40-660" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-661"><a href="ode.html#cb40-661" aria-hidden="true" tabindex="-1"></a>          <span class="do">## First, we create a modifier variable</span></span>
<span id="cb40-662"><a href="ode.html#cb40-662" aria-hidden="true" tabindex="-1"></a>          <span class="do">## It is set to one in case this is not a staging compartment</span></span>
<span id="cb40-663"><a href="ode.html#cb40-663" aria-hidden="true" tabindex="-1"></a>          <span class="do">## If it is a staging compartment, then the modifier is set to the staging modifier</span></span>
<span id="cb40-664"><a href="ode.html#cb40-664" aria-hidden="true" tabindex="-1"></a>          mod <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb40-665"><a href="ode.html#cb40-665" aria-hidden="true" tabindex="-1"></a>          <span class="do">## Can check if it is a staging compartment by seeing if the income_level</span></span>
<span id="cb40-666"><a href="ode.html#cb40-666" aria-hidden="true" tabindex="-1"></a>          <span class="do">## Matches up with income_5_cat[income_level] and if the income for the two compartments</span></span>
<span id="cb40-667"><a href="ode.html#cb40-667" aria-hidden="true" tabindex="-1"></a>          <span class="do">## is the same</span></span>
<span id="cb40-668"><a href="ode.html#cb40-668" aria-hidden="true" tabindex="-1"></a>          <span class="do">##if(income_level != income_5_cat[income_level] &amp;&amp; income == income_5_cat[income_level]){</span></span>
<span id="cb40-669"><a href="ode.html#cb40-669" aria-hidden="true" tabindex="-1"></a>          <span class="do">## mod &lt;- staging_modifier</span></span>
<span id="cb40-670"><a href="ode.html#cb40-670" aria-hidden="true" tabindex="-1"></a>          <span class="do">##}</span></span>
<span id="cb40-671"><a href="ode.html#cb40-671" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-672"><a href="ode.html#cb40-672" aria-hidden="true" tabindex="-1"></a>          <span class="do">## then the proportion of people who make the transition are the proportion of people</span></span>
<span id="cb40-673"><a href="ode.html#cb40-673" aria-hidden="true" tabindex="-1"></a>          <span class="do">## in the prior compartment who make the income transition</span></span>
<span id="cb40-674"><a href="ode.html#cb40-674" aria-hidden="true" tabindex="-1"></a>          <span class="do">## if it is from a staging compartment, the modifier impacts this rates</span></span>
<span id="cb40-675"><a href="ode.html#cb40-675" aria-hidden="true" tabindex="-1"></a>          incomeIn <span class="ot">&lt;-</span> incomeIn <span class="sc">+</span> states[sex,age,<span class="dv">3</span>,e_cigarette,income_level]<span class="sc">*</span>income_transitions[age,income_5_cat[income_level],income_5_cat[income]]<span class="sc">*</span>mod</span>
<span id="cb40-676"><a href="ode.html#cb40-676" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-677"><a href="ode.html#cb40-677" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb40-678"><a href="ode.html#cb40-678" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-679"><a href="ode.html#cb40-679" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Income Out</span></span>
<span id="cb40-680"><a href="ode.html#cb40-680" aria-hidden="true" tabindex="-1"></a>        incomeOut <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-681"><a href="ode.html#cb40-681" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Two cases, either someone is in a non-staging compartment (income == 1-5)</span></span>
<span id="cb40-682"><a href="ode.html#cb40-682" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Or in a staging compartment (income = 6-13)</span></span>
<span id="cb40-683"><a href="ode.html#cb40-683" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-684"><a href="ode.html#cb40-684" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(income_level <span class="cf">in</span> landings){</span>
<span id="cb40-685"><a href="ode.html#cb40-685" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-686"><a href="ode.html#cb40-686" aria-hidden="true" tabindex="-1"></a>          mod <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb40-687"><a href="ode.html#cb40-687" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-688"><a href="ode.html#cb40-688" aria-hidden="true" tabindex="-1"></a>          <span class="do">##if(income != income_5_cat[income] &amp;&amp; income_level == income_5_cat[income]){</span></span>
<span id="cb40-689"><a href="ode.html#cb40-689" aria-hidden="true" tabindex="-1"></a>          <span class="do">## mod &lt;- staging_modifier</span></span>
<span id="cb40-690"><a href="ode.html#cb40-690" aria-hidden="true" tabindex="-1"></a>          <span class="do">##}</span></span>
<span id="cb40-691"><a href="ode.html#cb40-691" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-692"><a href="ode.html#cb40-692" aria-hidden="true" tabindex="-1"></a>          incomeOut <span class="ot">&lt;-</span> incomeOut <span class="sc">+</span> states[sex,age,<span class="dv">3</span>,e_cigarette,income]<span class="sc">*</span>income_transitions[age,income_5_cat[income],income_5_cat[income_level]]<span class="sc">*</span>mod</span>
<span id="cb40-693"><a href="ode.html#cb40-693" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb40-694"><a href="ode.html#cb40-694" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb40-695"><a href="ode.html#cb40-695" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-696"><a href="ode.html#cb40-696" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-697"><a href="ode.html#cb40-697" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ## Income Out</span></span>
<span id="cb40-698"><a href="ode.html#cb40-698" aria-hidden="true" tabindex="-1"></a>        <span class="co"># incomeOut &lt;- 0</span></span>
<span id="cb40-699"><a href="ode.html#cb40-699" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ## Two cases, either someone is in a non-staging compartment (income == 1-5)</span></span>
<span id="cb40-700"><a href="ode.html#cb40-700" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ## Or in a staging compartment (income = 6-13)</span></span>
<span id="cb40-701"><a href="ode.html#cb40-701" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-702"><a href="ode.html#cb40-702" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ## First we consider a non-staging compartment</span></span>
<span id="cb40-703"><a href="ode.html#cb40-703" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if(income == income_5_cat[income]){</span></span>
<span id="cb40-704"><a href="ode.html#cb40-704" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## The number of people who transition out is just the proportion of people</span></span>
<span id="cb40-705"><a href="ode.html#cb40-705" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Whose income changes, which is 1 - the proportion of people whose income won&#39;t change</span></span>
<span id="cb40-706"><a href="ode.html#cb40-706" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   incomeOut &lt;- states[sex,age,3,e_cigarette,income]*(1 - income_transitions[age,income,income]) </span></span>
<span id="cb40-707"><a href="ode.html#cb40-707" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else{</span></span>
<span id="cb40-708"><a href="ode.html#cb40-708" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-709"><a href="ode.html#cb40-709" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Question: How do we define the transitions out of the staging compartments</span></span>
<span id="cb40-710"><a href="ode.html#cb40-710" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Is it just that everyone transitions out or is there a proportion that stays put</span></span>
<span id="cb40-711"><a href="ode.html#cb40-711" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## It seems like we need to establish a value S which captures how long people stay in these compartments</span></span>
<span id="cb40-712"><a href="ode.html#cb40-712" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-713"><a href="ode.html#cb40-713" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-714"><a href="ode.html#cb40-714" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-715"><a href="ode.html#cb40-715" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## There are two possible transitions</span></span>
<span id="cb40-716"><a href="ode.html#cb40-716" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Income level changes</span></span>
<span id="cb40-717"><a href="ode.html#cb40-717" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Income stabilization</span></span>
<span id="cb40-718"><a href="ode.html#cb40-718" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ##</span></span>
<span id="cb40-719"><a href="ode.html#cb40-719" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-720"><a href="ode.html#cb40-720" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## First we account for income changes</span></span>
<span id="cb40-721"><a href="ode.html#cb40-721" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Like in the first case, this is just the proportion of peoples whose income changes</span></span>
<span id="cb40-722"><a href="ode.html#cb40-722" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   incomeOut &lt;- states[sex,age,3,e_cigarette,income]*(1 - income_transitions[age,income_5_cat[income],income_5_cat[income]])</span></span>
<span id="cb40-723"><a href="ode.html#cb40-723" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-724"><a href="ode.html#cb40-724" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## Second we account for income stabilization</span></span>
<span id="cb40-725"><a href="ode.html#cb40-725" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## The transition out is thus the proportion of people in the compartment whose income</span></span>
<span id="cb40-726"><a href="ode.html#cb40-726" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## stays the same times the staging modifier. If the staging modifier is 0.5 then</span></span>
<span id="cb40-727"><a href="ode.html#cb40-727" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## half of the people whose income is stabilized would leave and go to the non-staging comaprtment</span></span>
<span id="cb40-728"><a href="ode.html#cb40-728" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   incomeOut &lt;- incomeOut + states[sex,age,3,e_cigarette,income]*income_transitions[age,income_5_cat[income],income_5_cat[income]]*staging_modifier</span></span>
<span id="cb40-729"><a href="ode.html#cb40-729" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-730"><a href="ode.html#cb40-730" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }</span></span>
<span id="cb40-731"><a href="ode.html#cb40-731" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-732"><a href="ode.html#cb40-732" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Cigarette In</span></span>
<span id="cb40-733"><a href="ode.html#cb40-733" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-734"><a href="ode.html#cb40-734" aria-hidden="true" tabindex="-1"></a>        cigaretteIn <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-735"><a href="ode.html#cb40-735" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-736"><a href="ode.html#cb40-736" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Need a flow for cessation</span></span>
<span id="cb40-737"><a href="ode.html#cb40-737" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-738"><a href="ode.html#cb40-738" aria-hidden="true" tabindex="-1"></a>        cigaretteIn <span class="ot">&lt;-</span> cigaretteIn <span class="sc">+</span> states[sex,age,<span class="dv">2</span>,e_cigarette,income]<span class="sc">*</span>(cigarette_transitions[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">*</span>rr_cigarette_cessation[sex,age,e_cigarette,income])</span>
<span id="cb40-739"><a href="ode.html#cb40-739" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-740"><a href="ode.html#cb40-740" aria-hidden="true" tabindex="-1"></a>        <span class="do">## cigarette Out</span></span>
<span id="cb40-741"><a href="ode.html#cb40-741" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-742"><a href="ode.html#cb40-742" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Former Smoker to Current Smoker</span></span>
<span id="cb40-743"><a href="ode.html#cb40-743" aria-hidden="true" tabindex="-1"></a>        cigaretteOut <span class="ot">&lt;-</span> states[sex,age,<span class="dv">3</span>,e_cigarette,income]<span class="sc">*</span>(cigarette_transitions[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">*</span>rr_cigarette_reinstatement[sex,age,e_cigarette,income])</span>
<span id="cb40-744"><a href="ode.html#cb40-744" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-745"><a href="ode.html#cb40-745" aria-hidden="true" tabindex="-1"></a>        <span class="do">## E-Cigarette Transitions</span></span>
<span id="cb40-746"><a href="ode.html#cb40-746" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-747"><a href="ode.html#cb40-747" aria-hidden="true" tabindex="-1"></a>        <span class="do">## e_cigarette in</span></span>
<span id="cb40-748"><a href="ode.html#cb40-748" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-749"><a href="ode.html#cb40-749" aria-hidden="true" tabindex="-1"></a>        e_cigaretteIn <span class="ot">&lt;-</span> states[sex,age,<span class="dv">3</span>,<span class="dv">1</span>,income]<span class="sc">*</span>(e_cigarette_transitions[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>rr_e_cigarette_initiation[sex,age,<span class="dv">3</span>,income])<span class="sc">*</span>e_cig_in[<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb40-750"><a href="ode.html#cb40-750" aria-hidden="true" tabindex="-1"></a>          states[sex,age,<span class="dv">3</span>,<span class="dv">2</span>,income]<span class="sc">*</span>(e_cigarette_transitions[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">*</span>rr_e_cigarette_cessation[sex,age,<span class="dv">3</span>,income])<span class="sc">*</span>e_cig_in[<span class="dv">2</span>] <span class="sc">+</span></span>
<span id="cb40-751"><a href="ode.html#cb40-751" aria-hidden="true" tabindex="-1"></a>          states[sex,age,<span class="dv">3</span>,<span class="dv">3</span>,income]<span class="sc">*</span>(e_cigarette_transitions[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">*</span>rr_e_cigarette_reinstatement[sex,age,<span class="dv">3</span>,income])<span class="sc">*</span>e_cig_in[<span class="dv">3</span>]</span>
<span id="cb40-752"><a href="ode.html#cb40-752" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-753"><a href="ode.html#cb40-753" aria-hidden="true" tabindex="-1"></a>        <span class="co"># e_cigaretteIn &lt;- 0</span></span>
<span id="cb40-754"><a href="ode.html#cb40-754" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-755"><a href="ode.html#cb40-755" aria-hidden="true" tabindex="-1"></a>        <span class="co"># # if(e_cigarette == 1){</span></span>
<span id="cb40-756"><a href="ode.html#cb40-756" aria-hidden="true" tabindex="-1"></a>        <span class="co"># #   </span></span>
<span id="cb40-757"><a href="ode.html#cb40-757" aria-hidden="true" tabindex="-1"></a>        <span class="co"># #   ## never e-cig smoker and therefore there is no in flow</span></span>
<span id="cb40-758"><a href="ode.html#cb40-758" aria-hidden="true" tabindex="-1"></a>        <span class="co"># #   </span></span>
<span id="cb40-759"><a href="ode.html#cb40-759" aria-hidden="true" tabindex="-1"></a>        <span class="co"># # }else </span></span>
<span id="cb40-760"><a href="ode.html#cb40-760" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if(e_cigarette == 2){</span></span>
<span id="cb40-761"><a href="ode.html#cb40-761" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-762"><a href="ode.html#cb40-762" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for initiation 1 - 2</span></span>
<span id="cb40-763"><a href="ode.html#cb40-763" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-764"><a href="ode.html#cb40-764" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteIn &lt;- e_cigaretteIn + states[sex,age,3,1,income]*(e_cigarette_transitions[1,2]*rr_e_cigarette_initiation[sex,age,3,income])</span></span>
<span id="cb40-765"><a href="ode.html#cb40-765" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-766"><a href="ode.html#cb40-766" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for reinstatement</span></span>
<span id="cb40-767"><a href="ode.html#cb40-767" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-768"><a href="ode.html#cb40-768" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteIn &lt;- e_cigaretteIn + states[sex,age,3,3,income]*(e_cigarette_transitions[3,2]*rr_e_cigarette_reinstatement[sex,age,3,income])</span></span>
<span id="cb40-769"><a href="ode.html#cb40-769" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-770"><a href="ode.html#cb40-770" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else if(e_cigarette == 3){</span></span>
<span id="cb40-771"><a href="ode.html#cb40-771" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-772"><a href="ode.html#cb40-772" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for cessation</span></span>
<span id="cb40-773"><a href="ode.html#cb40-773" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-774"><a href="ode.html#cb40-774" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteIn &lt;- e_cigaretteIn + states[sex,age,3,2,income]*(e_cigarette_transitions[2,3]*rr_e_cigarette_cessation[sex,age,3,income])</span></span>
<span id="cb40-775"><a href="ode.html#cb40-775" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-776"><a href="ode.html#cb40-776" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }</span></span>
<span id="cb40-777"><a href="ode.html#cb40-777" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-778"><a href="ode.html#cb40-778" aria-hidden="true" tabindex="-1"></a>        <span class="do">## e_cigarette out</span></span>
<span id="cb40-779"><a href="ode.html#cb40-779" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-780"><a href="ode.html#cb40-780" aria-hidden="true" tabindex="-1"></a>        e_cigaretteOut <span class="ot">&lt;-</span>  states[sex,age,<span class="dv">3</span>,e_cigarette,income]<span class="sc">*</span>(e_cigarette_transitions[e_cigarette,cig_out[e_cigarette]]<span class="sc">*</span>rr_e_cigarette_transitions[e_cigarette,sex,age,<span class="dv">3</span>,income])</span>
<span id="cb40-781"><a href="ode.html#cb40-781" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-782"><a href="ode.html#cb40-782" aria-hidden="true" tabindex="-1"></a>        <span class="co"># e_cigaretteOut &lt;- 0</span></span>
<span id="cb40-783"><a href="ode.html#cb40-783" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span></span>
<span id="cb40-784"><a href="ode.html#cb40-784" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if(e_cigarette == 1){</span></span>
<span id="cb40-785"><a href="ode.html#cb40-785" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-786"><a href="ode.html#cb40-786" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for initiation</span></span>
<span id="cb40-787"><a href="ode.html#cb40-787" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-788"><a href="ode.html#cb40-788" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteOut &lt;- e_cigaretteOut + states[sex,age,3,e_cigarette,income]*(e_cigarette_transitions[1,2]*rr_e_cigarette_initiation[sex,age,3,income])</span></span>
<span id="cb40-789"><a href="ode.html#cb40-789" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-790"><a href="ode.html#cb40-790" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else if(e_cigarette == 2){</span></span>
<span id="cb40-791"><a href="ode.html#cb40-791" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-792"><a href="ode.html#cb40-792" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for cessation</span></span>
<span id="cb40-793"><a href="ode.html#cb40-793" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-794"><a href="ode.html#cb40-794" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteOut &lt;- e_cigaretteOut + states[sex,age,3,e_cigarette,income]*(e_cigarette_transitions[2,3]*rr_e_cigarette_cessation[sex,age,3,income])</span></span>
<span id="cb40-795"><a href="ode.html#cb40-795" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-796"><a href="ode.html#cb40-796" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }else if(e_cigarette == 3){</span></span>
<span id="cb40-797"><a href="ode.html#cb40-797" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-798"><a href="ode.html#cb40-798" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   ## need a flow for reinstatement</span></span>
<span id="cb40-799"><a href="ode.html#cb40-799" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-800"><a href="ode.html#cb40-800" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   e_cigaretteOut &lt;- e_cigaretteOut + states[sex,age,3,e_cigarette,income]*(e_cigarette_transitions[3,2]*rr_e_cigarette_reinstatement[sex,age,3,income])</span></span>
<span id="cb40-801"><a href="ode.html#cb40-801" aria-hidden="true" tabindex="-1"></a>        <span class="co">#   </span></span>
<span id="cb40-802"><a href="ode.html#cb40-802" aria-hidden="true" tabindex="-1"></a>        <span class="co"># }</span></span>
<span id="cb40-803"><a href="ode.html#cb40-803" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-804"><a href="ode.html#cb40-804" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Death</span></span>
<span id="cb40-805"><a href="ode.html#cb40-805" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-806"><a href="ode.html#cb40-806" aria-hidden="true" tabindex="-1"></a>        death <span class="ot">&lt;-</span> states[sex,age,<span class="dv">3</span>,e_cigarette,income]<span class="sc">*</span>death_rates[sex,age]<span class="sc">*</span>excess_cigarette_death_RR[sex,<span class="dv">3</span>]</span>
<span id="cb40-807"><a href="ode.html#cb40-807" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-808"><a href="ode.html#cb40-808" aria-hidden="true" tabindex="-1"></a>        <span class="do">## ODE 3</span></span>
<span id="cb40-809"><a href="ode.html#cb40-809" aria-hidden="true" tabindex="-1"></a>        ODEs[sex,age, <span class="dv">3</span>, e_cigarette, income] <span class="ot">&lt;-</span> ageIn <span class="sc">-</span> ageOut <span class="sc">+</span> incomeIn <span class="sc">-</span> incomeOut <span class="sc">+</span> e_cigaretteIn <span class="sc">-</span> e_cigaretteOut <span class="sc">+</span> cigaretteIn <span class="sc">-</span> cigaretteOut <span class="sc">-</span> death</span>
<span id="cb40-810"><a href="ode.html#cb40-810" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb40-811"><a href="ode.html#cb40-811" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb40-812"><a href="ode.html#cb40-812" aria-hidden="true" tabindex="-1"></a>    <span class="co"># }</span></span>
<span id="cb40-813"><a href="ode.html#cb40-813" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-814"><a href="ode.html#cb40-814" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-815"><a href="ode.html#cb40-815" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-816"><a href="ode.html#cb40-816" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-817"><a href="ode.html#cb40-817" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-818"><a href="ode.html#cb40-818" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return(list(c(dE,dV,dA,dB,dC,dD,dEx)))</span></span>
<span id="cb40-819"><a href="ode.html#cb40-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">toVector</span>(ODEs)))</span>
<span id="cb40-820"><a href="ode.html#cb40-820" aria-hidden="true" tabindex="-1"></a>  <span class="co"># })</span></span>
<span id="cb40-821"><a href="ode.html#cb40-821" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="start.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="calibration.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

</body>

</html>
